!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Matter=e()}}(function(){return function r(s,a,l){function c(t,e){if(!a[t]){if(!s[t]){var o="function"==typeof require&&require;if(!e&&o)return o(t,!0);if(d)return d(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var i=a[t]={exports:{}};s[t][0].call(i.exports,function(e){return c(s[t][1][e]||e)},i,i.exports,r,s,a,l)}return a[t].exports}for(var d="function"==typeof require&&require,e=0;e<l.length;e++)c(l[e]);return c}({1:[function(e,t,o){var c={};t.exports=c;var d=e("../geometry/Vertices"),u=e("../geometry/Vector"),i=e("../core/Sleeping"),r=(e("../render/Render"),e("../core/Common")),p=e("../geometry/Bounds"),m=e("../geometry/Axes");!function(){c._inertiaScale=4,c._nextCollidingGroupId=1,c._nextNonCollidingGroupId=-1,c._nextCategory=1,c.create=function(e){var t={id:r.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:d.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0},lineWidth:0}},o=r.extend(t,e);return n(o,e),o},c.nextGroup=function(e){return e?c._nextNonCollidingGroupId--:c._nextCollidingGroupId++},c.nextCategory=function(){return c._nextCategory=c._nextCategory<<1,c._nextCategory};var n=function(e,t){t=t||{},c.set(e,{bounds:e.bounds||p.create(e.vertices),positionPrev:e.positionPrev||u.clone(e.position),anglePrev:e.anglePrev||e.angle,vertices:e.vertices,parts:e.parts||[e],isStatic:e.isStatic,isSleeping:e.isSleeping,parent:e.parent||e}),d.rotate(e.vertices,e.angle,e.position),m.rotate(e.axes,e.angle),p.update(e.bounds,e.vertices,e.velocity),c.set(e,{axes:t.axes||e.axes,area:t.area||e.area,mass:t.mass||e.mass,inertia:t.inertia||e.inertia});var o=e.isStatic?"#2e2b44":r.choose(["#006BA6","#0496FF","#FFBC42","#D81159","#8F2D56"]);e.render.fillStyle=e.render.fillStyle||o,e.render.strokeStyle=e.render.strokeStyle||"#000",e.render.sprite.xOffset+=-(e.bounds.min.x-e.position.x)/(e.bounds.max.x-e.bounds.min.x),e.render.sprite.yOffset+=-(e.bounds.min.y-e.position.y)/(e.bounds.max.y-e.bounds.min.y)};c.set=function(e,t,o){var n;for(n in"string"==typeof t&&(n=t,(t={})[n]=o),t)if(o=t[n],t.hasOwnProperty(n))switch(n){case"isStatic":c.setStatic(e,o);break;case"isSleeping":i.set(e,o);break;case"mass":c.setMass(e,o);break;case"density":c.setDensity(e,o);break;case"inertia":c.setInertia(e,o);break;case"vertices":c.setVertices(e,o);break;case"position":c.setPosition(e,o);break;case"angle":c.setAngle(e,o);break;case"velocity":c.setVelocity(e,o);break;case"angularVelocity":c.setAngularVelocity(e,o);break;case"parts":c.setParts(e,o);break;default:e[n]=o}},c.setStatic=function(e,t){for(var o=0;o<e.parts.length;o++){var n=e.parts[o];(n.isStatic=t)?(n._original={restitution:n.restitution,friction:n.friction,mass:n.mass,inertia:n.inertia,density:n.density,inverseMass:n.inverseMass,inverseInertia:n.inverseInertia},n.restitution=0,n.friction=1,n.mass=n.inertia=n.density=1/0,n.inverseMass=n.inverseInertia=0,n.positionPrev.x=n.position.x,n.positionPrev.y=n.position.y,n.anglePrev=n.angle,n.angularVelocity=0,n.speed=0,n.angularSpeed=0,n.motion=0):n._original&&(n.restitution=n._original.restitution,n.friction=n._original.friction,n.mass=n._original.mass,n.inertia=n._original.inertia,n.density=n._original.density,n.inverseMass=n._original.inverseMass,n.inverseInertia=n._original.inverseInertia,delete n._original)}},c.setMass=function(e,t){var o=e.inertia/(e.mass/6);e.inertia=o*(t/6),e.inverseInertia=1/e.inertia,e.mass=t,e.inverseMass=1/e.mass,e.density=e.mass/e.area},c.setDensity=function(e,t){c.setMass(e,t*e.area),e.density=t},c.setInertia=function(e,t){e.inertia=t,e.inverseInertia=1/e.inertia},c.setVertices=function(e,t){t[0].body===e?e.vertices=t:e.vertices=d.create(t,e),e.axes=m.fromVertices(e.vertices),e.area=d.area(e.vertices),c.setMass(e,e.density*e.area);var o=d.centre(e.vertices);d.translate(e.vertices,o,-1),c.setInertia(e,c._inertiaScale*d.inertia(e.vertices,e.mass)),d.translate(e.vertices,e.position),p.update(e.bounds,e.vertices,e.velocity)},c.setParts=function(e,t,o){var n;for(t=t.slice(0),e.parts.length=0,e.parts.push(e),e.parent=e,n=0;n<t.length;n++){var i=t[n];i!==e&&(i.parent=e).parts.push(i)}if(1!==e.parts.length){if(o=void 0===o||o){var r=[];for(n=0;n<t.length;n++)r=r.concat(t[n].vertices);d.clockwiseSort(r);var s=d.hull(r),a=d.centre(s);c.setVertices(e,s),d.translate(e.vertices,a)}var l=c._totalProperties(e);e.area=l.area,(e.parent=e).position.x=l.centre.x,e.position.y=l.centre.y,e.positionPrev.x=l.centre.x,e.positionPrev.y=l.centre.y,c.setMass(e,l.mass),c.setInertia(e,l.inertia),c.setPosition(e,l.centre)}},c.setPosition=function(e,t){var o=u.sub(t,e.position);e.positionPrev.x+=o.x,e.positionPrev.y+=o.y;for(var n=0;n<e.parts.length;n++){var i=e.parts[n];i.position.x+=o.x,i.position.y+=o.y,d.translate(i.vertices,o),p.update(i.bounds,i.vertices,e.velocity)}},c.setAngle=function(e,t){var o=t-e.angle;e.anglePrev+=o;for(var n=0;n<e.parts.length;n++){var i=e.parts[n];i.angle+=o,d.rotate(i.vertices,o,e.position),m.rotate(i.axes,o),p.update(i.bounds,i.vertices,e.velocity),0<n&&u.rotateAbout(i.position,o,e.position,i.position)}},c.setVelocity=function(e,t){e.positionPrev.x=e.position.x-t.x,e.positionPrev.y=e.position.y-t.y,e.velocity.x=t.x,e.velocity.y=t.y,e.speed=u.magnitude(e.velocity)},c.setAngularVelocity=function(e,t){e.anglePrev=e.angle-t,e.angularVelocity=t,e.angularSpeed=Math.abs(e.angularVelocity)},c.translate=function(e,t){c.setPosition(e,u.add(e.position,t))},c.rotate=function(e,t,o){if(o){var n=Math.cos(t),i=Math.sin(t),r=e.position.x-o.x,s=e.position.y-o.y;c.setPosition(e,{x:o.x+(r*n-s*i),y:o.y+(r*i+s*n)}),c.setAngle(e,e.angle+t)}else c.setAngle(e,e.angle+t)},c.scale=function(e,t,o,n){var i=0,r=0;n=n||e.position;for(var s=0;s<e.parts.length;s++){var a=e.parts[s];d.scale(a.vertices,t,o,n),a.axes=m.fromVertices(a.vertices),a.area=d.area(a.vertices),c.setMass(a,e.density*a.area),d.translate(a.vertices,{x:-a.position.x,y:-a.position.y}),c.setInertia(a,c._inertiaScale*d.inertia(a.vertices,a.mass)),d.translate(a.vertices,{x:a.position.x,y:a.position.y}),0<s&&(i+=a.area,r+=a.inertia),a.position.x=n.x+(a.position.x-n.x)*t,a.position.y=n.y+(a.position.y-n.y)*o,p.update(a.bounds,a.vertices,e.velocity)}1<e.parts.length&&(e.area=i,e.isStatic||(c.setMass(e,e.density*i),c.setInertia(e,r))),e.circleRadius&&(t===o?e.circleRadius*=t:e.circleRadius=null)},c.update=function(e,t,o,n){var i=Math.pow(t*o*e.timeScale,2),r=1-e.frictionAir*o*e.timeScale,s=e.position.x-e.positionPrev.x,a=e.position.y-e.positionPrev.y;e.velocity.x=s*r*n+e.force.x/e.mass*i,e.velocity.y=a*r*n+e.force.y/e.mass*i,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.position.x+=e.velocity.x,e.position.y+=e.velocity.y,e.angularVelocity=(e.angle-e.anglePrev)*r*n+e.torque/e.inertia*i,e.anglePrev=e.angle,e.angle+=e.angularVelocity,e.speed=u.magnitude(e.velocity),e.angularSpeed=Math.abs(e.angularVelocity);for(var l=0;l<e.parts.length;l++){var c=e.parts[l];d.translate(c.vertices,e.velocity),0<l&&(c.position.x+=e.velocity.x,c.position.y+=e.velocity.y),0!==e.angularVelocity&&(d.rotate(c.vertices,e.angularVelocity,e.position),m.rotate(c.axes,e.angularVelocity),0<l&&u.rotateAbout(c.position,e.angularVelocity,e.position,c.position)),p.update(c.bounds,c.vertices,e.velocity)}},c.applyForce=function(e,t,o){e.force.x+=o.x,e.force.y+=o.y;var n=t.x-e.position.x,i=t.y-e.position.y;e.torque+=n*o.y-i*o.x},c._totalProperties=function(e){for(var t={mass:0,area:0,inertia:0,centre:{x:0,y:0}},o=1===e.parts.length?0:1;o<e.parts.length;o++){var n=e.parts[o],i=n.mass!==1/0?n.mass:1;t.mass+=i,t.area+=n.area,t.inertia+=n.inertia,t.centre=u.add(t.centre,u.mult(n.position,i))}return t.centre=u.div(t.centre,t.mass),t}}()},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31}],2:[function(e,t,o){var u={};t.exports=u;var s=e("../core/Events"),r=e("../core/Common"),a=e("../geometry/Bounds"),p=e("./Body");u.create=function(e){return r.extend({id:r.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{}},e)},u.setModified=function(e,t,o,n){if(e.isModified=t,o&&e.parent&&u.setModified(e.parent,t,o,n),n)for(var i=0;i<e.composites.length;i++){var r=e.composites[i];u.setModified(r,t,o,n)}},u.add=function(e,t){var o=[].concat(t);s.trigger(e,"beforeAdd",{object:t});for(var n=0;n<o.length;n++){var i=o[n];switch(i.type){case"body":if(i.parent!==i){r.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}u.addBody(e,i);break;case"constraint":u.addConstraint(e,i);break;case"composite":u.addComposite(e,i);break;case"mouseConstraint":u.addConstraint(e,i.constraint)}}return s.trigger(e,"afterAdd",{object:t}),e},u.remove=function(e,t,o){var n=[].concat(t);s.trigger(e,"beforeRemove",{object:t});for(var i=0;i<n.length;i++){var r=n[i];switch(r.type){case"body":u.removeBody(e,r,o);break;case"constraint":u.removeConstraint(e,r,o);break;case"composite":u.removeComposite(e,r,o);break;case"mouseConstraint":u.removeConstraint(e,r.constraint)}}return s.trigger(e,"afterRemove",{object:t}),e},u.addComposite=function(e,t){return e.composites.push(t),t.parent=e,u.setModified(e,!0,!0,!1),e},u.removeComposite=function(e,t,o){var n=r.indexOf(e.composites,t);if(-1!==n&&(u.removeCompositeAt(e,n),u.setModified(e,!0,!0,!1)),o)for(var i=0;i<e.composites.length;i++)u.removeComposite(e.composites[i],t,!0);return e},u.removeCompositeAt=function(e,t){return e.composites.splice(t,1),u.setModified(e,!0,!0,!1),e},u.addBody=function(e,t){return e.bodies.push(t),u.setModified(e,!0,!0,!1),e},u.removeBody=function(e,t,o){var n=r.indexOf(e.bodies,t);if(-1!==n&&(u.removeBodyAt(e,n),u.setModified(e,!0,!0,!1)),o)for(var i=0;i<e.composites.length;i++)u.removeBody(e.composites[i],t,!0);return e},u.removeBodyAt=function(e,t){return e.bodies.splice(t,1),u.setModified(e,!0,!0,!1),e},u.addConstraint=function(e,t){return e.constraints.push(t),u.setModified(e,!0,!0,!1),e},u.removeConstraint=function(e,t,o){var n=r.indexOf(e.constraints,t);if(-1!==n&&u.removeConstraintAt(e,n),o)for(var i=0;i<e.composites.length;i++)u.removeConstraint(e.composites[i],t,!0);return e},u.removeConstraintAt=function(e,t){return e.constraints.splice(t,1),u.setModified(e,!0,!0,!1),e},u.clear=function(e,t,o){if(o)for(var n=0;n<e.composites.length;n++)u.clear(e.composites[n],t,!0);return t?e.bodies=e.bodies.filter(function(e){return e.isStatic}):e.bodies.length=0,e.constraints.length=0,e.composites.length=0,u.setModified(e,!0,!0,!1),e},u.allBodies=function(e){for(var t=[].concat(e.bodies),o=0;o<e.composites.length;o++)t=t.concat(u.allBodies(e.composites[o]));return t},u.allConstraints=function(e){for(var t=[].concat(e.constraints),o=0;o<e.composites.length;o++)t=t.concat(u.allConstraints(e.composites[o]));return t},u.allComposites=function(e){for(var t=[].concat(e.composites),o=0;o<e.composites.length;o++)t=t.concat(u.allComposites(e.composites[o]));return t},u.get=function(e,t,o){var n,i;switch(o){case"body":n=u.allBodies(e);break;case"constraint":n=u.allConstraints(e);break;case"composite":n=u.allComposites(e).concat(e)}return n?0===(i=n.filter(function(e){return e.id.toString()===t.toString()})).length?null:i[0]:null},u.move=function(e,t,o){return u.remove(e,t),u.add(o,t),e},u.rebase=function(e){for(var t=u.allBodies(e).concat(u.allConstraints(e)).concat(u.allComposites(e)),o=0;o<t.length;o++)t[o].id=r.nextId();return u.setModified(e,!0,!0,!1),e},u.translate=function(e,t,o){for(var n=o?u.allBodies(e):e.bodies,i=0;i<n.length;i++)p.translate(n[i],t);return u.setModified(e,!0,!0,!1),e},u.rotate=function(e,t,o,n){for(var i=Math.cos(t),r=Math.sin(t),s=n?u.allBodies(e):e.bodies,a=0;a<s.length;a++){var l=s[a],c=l.position.x-o.x,d=l.position.y-o.y;p.setPosition(l,{x:o.x+(c*i-d*r),y:o.y+(c*r+d*i)}),p.rotate(l,t)}return u.setModified(e,!0,!0,!1),e},u.scale=function(e,t,o,n,i){for(var r=i?u.allBodies(e):e.bodies,s=0;s<r.length;s++){var a=r[s],l=a.position.x-n.x,c=a.position.y-n.y;p.setPosition(a,{x:n.x+l*t,y:n.y+c*o}),p.scale(a,t,o)}return u.setModified(e,!0,!0,!1),e},u.bounds=function(e){for(var t=u.allBodies(e),o=[],n=0;n<t.length;n+=1){var i=t[n];o.push(i.bounds.min,i.bounds.max)}return a.create(o)}},{"../core/Common":14,"../core/Events":16,"../geometry/Bounds":26,"./Body":1}],3:[function(e,t,o){var n={};t.exports=n;var i=e("./Composite"),r=(e("../constraint/Constraint"),e("../core/Common"));n.create=function(e){var t=i.create(),o={label:"World",gravity:{x:0,y:1,scale:.001},bounds:{min:{x:-1/0,y:-1/0},max:{x:1/0,y:1/0}}};return r.extend(t,o,e)}},{"../constraint/Constraint":12,"../core/Common":14,"./Composite":2}],4:[function(e,t,o){var n={};(t.exports=n).create=function(e){return{id:n.id(e),vertex:e,normalImpulse:0,tangentImpulse:0}},n.id=function(e){return e.body.id+"_"+e.index}},{}],5:[function(e,t,o){var f={};t.exports=f;var v=e("./SAT"),y=e("./Pair"),g=e("../geometry/Bounds");f.collisions=function(e,t){for(var o=[],n=t.pairs.table,i=0;i<e.length;i++){var r=e[i][0],s=e[i][1];if((!r.isStatic&&!r.isSleeping||!s.isStatic&&!s.isSleeping)&&f.canCollide(r.collisionFilter,s.collisionFilter)&&g.overlaps(r.bounds,s.bounds))for(var a=1<r.parts.length?1:0;a<r.parts.length;a++)for(var l=r.parts[a],c=1<s.parts.length?1:0;c<s.parts.length;c++){var d=s.parts[c];if(l===r&&d===s||g.overlaps(l.bounds,d.bounds)){var u,p=n[y.id(l,d)];u=p&&p.isActive?p.collision:null;var m=v.collides(l,d,u);m.collided&&o.push(m)}}}return o},f.canCollide=function(e,t){return e.group===t.group&&0!==e.group?0<e.group:0!=(e.mask&t.category)&&0!=(t.mask&e.category)}},{"../geometry/Bounds":26,"./Pair":7,"./SAT":11}],6:[function(e,t,o){var g={};t.exports=g;var a=e("./Pair"),n=e("./Detector"),l=e("../core/Common");g.create=function(e){var t={controller:g,detector:n.collisions,buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return l.extend(t,e)},g.update=function(e,t,o,n){var i,r,s,a,l,c=o.world,d=e.buckets,u=!1;for(i=0;i<t.length;i++){var p=t[i];if((!p.isSleeping||n)&&!(p.bounds.max.x<c.bounds.min.x||p.bounds.min.x>c.bounds.max.x||p.bounds.max.y<c.bounds.min.y||p.bounds.min.y>c.bounds.max.y)){var m=g._getRegion(e,p);if(!p.region||m.id!==p.region.id||n){p.region&&!n||(p.region=m);var f=g._regionUnion(m,p.region);for(r=f.startCol;r<=f.endCol;r++)for(s=f.startRow;s<=f.endRow;s++){a=d[l=g._getBucketId(r,s)];var v=r>=m.startCol&&r<=m.endCol&&s>=m.startRow&&s<=m.endRow,y=r>=p.region.startCol&&r<=p.region.endCol&&s>=p.region.startRow&&s<=p.region.endRow;!v&&y&&y&&a&&g._bucketRemoveBody(e,a,p),(p.region===m||v&&!y||n)&&(a||(a=g._createBucket(d,l)),g._bucketAddBody(e,a,p))}p.region=m,u=!0}}}u&&(e.pairsList=g._createActivePairsList(e))},g.clear=function(e){e.buckets={},e.pairs={},e.pairsList=[]},g._regionUnion=function(e,t){var o=Math.min(e.startCol,t.startCol),n=Math.max(e.endCol,t.endCol),i=Math.min(e.startRow,t.startRow),r=Math.max(e.endRow,t.endRow);return g._createRegion(o,n,i,r)},g._getRegion=function(e,t){var o=t.bounds,n=Math.floor(o.min.x/e.bucketWidth),i=Math.floor(o.max.x/e.bucketWidth),r=Math.floor(o.min.y/e.bucketHeight),s=Math.floor(o.max.y/e.bucketHeight);return g._createRegion(n,i,r,s)},g._createRegion=function(e,t,o,n){return{id:e+","+t+","+o+","+n,startCol:e,endCol:t,startRow:o,endRow:n}},g._getBucketId=function(e,t){return"C"+e+"R"+t},g._createBucket=function(e,t){return e[t]=[]},g._bucketAddBody=function(e,t,o){for(var n=0;n<t.length;n++){var i=t[n];if(!(o.id===i.id||o.isStatic&&i.isStatic)){var r=a.id(o,i),s=e.pairs[r];s?s[2]+=1:e.pairs[r]=[o,i,1]}}t.push(o)},g._bucketRemoveBody=function(e,t,o){t.splice(l.indexOf(t,o),1);for(var n=0;n<t.length;n++){var i=t[n],r=a.id(o,i),s=e.pairs[r];s&&(s[2]-=1)}},g._createActivePairsList=function(e){var t,o,n=[];t=l.keys(e.pairs);for(var i=0;i<t.length;i++)0<(o=e.pairs[t[i]])[2]?n.push(o):delete e.pairs[t[i]];return n}},{"../core/Common":14,"./Detector":5,"./Pair":7}],7:[function(e,t,o){var p={};t.exports=p;var m=e("./Contact");p.create=function(e,t){var o=e.bodyA,n=e.bodyB,i=e.parentA,r=e.parentB,s={id:p.id(o,n),bodyA:o,bodyB:n,contacts:{},activeContacts:[],separation:0,isActive:!0,isSensor:o.isSensor||n.isSensor,timeCreated:t,timeUpdated:t,inverseMass:i.inverseMass+r.inverseMass,friction:Math.min(i.friction,r.friction),frictionStatic:Math.max(i.frictionStatic,r.frictionStatic),restitution:Math.max(i.restitution,r.restitution),slop:Math.max(i.slop,r.slop)};return p.update(s,e,t),s},p.update=function(e,t,o){var n=e.contacts,i=t.supports,r=e.activeContacts,s=t.parentA,a=t.parentB;if(e.collision=t,e.inverseMass=s.inverseMass+a.inverseMass,e.friction=Math.min(s.friction,a.friction),e.frictionStatic=Math.max(s.frictionStatic,a.frictionStatic),e.restitution=Math.max(s.restitution,a.restitution),e.slop=Math.max(s.slop,a.slop),r.length=0,t.collided){for(var l=0;l<i.length;l++){var c=i[l],d=m.id(c),u=n[d];u?r.push(u):r.push(n[d]=m.create(c))}e.separation=t.depth,p.setActive(e,!0,o)}else!0===e.isActive&&p.setActive(e,!1,o)},p.setActive=function(e,t,o){t?(e.isActive=!0,e.timeUpdated=o):(e.isActive=!1,e.activeContacts.length=0)},p.id=function(e,t){return e.id<t.id?"A"+e.id+"B"+t.id:"A"+t.id+"B"+e.id}},{"./Contact":4}],8:[function(e,t,o){var c={};t.exports=c;var m=e("./Pair"),f=e("../core/Common");c._pairMaxIdleLife=1e3,c.create=function(e){return f.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},e)},c.update=function(e,t,o){var n,i,r,s,a=e.list,l=e.table,c=e.collisionStart,d=e.collisionEnd,u=e.collisionActive,p=[];for(c.length=0,d.length=0,s=u.length=0;s<t.length;s++)(n=t[s]).collided&&(i=m.id(n.bodyA,n.bodyB),p.push(i),(r=l[i])?(r.isActive?u.push(r):c.push(r),m.update(r,n,o)):(r=m.create(n,o),l[i]=r,c.push(r),a.push(r)));for(s=0;s<a.length;s++)(r=a[s]).isActive&&-1===f.indexOf(p,r.id)&&(m.setActive(r,!1,o),d.push(r))},c.removeOld=function(e,t){var o,n,i,r,s=e.list,a=e.table,l=[];for(r=0;r<s.length;r++)(n=(o=s[r]).collision).bodyA.isSleeping||n.bodyB.isSleeping?o.timeUpdated=t:t-o.timeUpdated>c._pairMaxIdleLife&&l.push(r);for(r=0;r<l.length;r++)delete a[(o=s[i=l[r]-r]).id],s.splice(i,1)},c.clear=function(e){return e.table={},e.list.length=0,e.collisionStart.length=0,e.collisionActive.length=0,e.collisionEnd.length=0,e}},{"../core/Common":14,"./Pair":7}],9:[function(e,t,o){var p={};t.exports=p;var m=e("../geometry/Vector"),l=e("./SAT"),c=e("../geometry/Bounds"),f=e("../factory/Bodies"),a=e("../geometry/Vertices");p.collides=function(e,t){for(var o=[],n=0;n<t.length;n++){var i=t[n];if(c.overlaps(i.bounds,e.bounds))for(var r=1===i.parts.length?0:1;r<i.parts.length;r++){var s=i.parts[r];if(c.overlaps(s.bounds,e.bounds)){var a=l.collides(s,e);if(a.collided){o.push(a);break}}}}return o},p.ray=function(e,t,o,n){n=n||1e-100;for(var i=m.angle(t,o),r=m.magnitude(m.sub(t,o)),s=.5*(o.x+t.x),a=.5*(o.y+t.y),l=f.rectangle(s,a,r,n,{angle:i}),c=p.collides(l,e),d=0;d<c.length;d+=1){var u=c[d];u.body=u.bodyB=u.bodyA}return c},p.region=function(e,t,o){for(var n=[],i=0;i<e.length;i++){var r=e[i],s=c.overlaps(r.bounds,t);(s&&!o||!s&&o)&&n.push(r)}return n},p.point=function(e,t){for(var o=[],n=0;n<e.length;n++){var i=e[n];if(c.contains(i.bounds,t))for(var r=1===i.parts.length?0:1;r<i.parts.length;r++){var s=i.parts[r];if(c.contains(s.bounds,t)&&a.contains(s.vertices,t)){o.push(i);break}}}return o}},{"../factory/Bodies":23,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"./SAT":11}],10:[function(e,t,o){var W={};t.exports=W;var r=e("../geometry/Vertices"),D=e("../geometry/Vector"),N=e("../core/Common"),s=e("../geometry/Bounds");W._restingThresh=4,W._restingThreshTangent=6,W._positionDampen=.9,W._positionWarming=.8,W._frictionNormalMultiplier=5,W.preSolvePosition=function(e){var t,o,n;for(t=0;t<e.length;t++)(o=e[t]).isActive&&(n=o.activeContacts.length,o.collision.parentA.totalContacts+=n,o.collision.parentB.totalContacts+=n)},W.solvePosition=function(e,t){var o,n,i,r,s,a,l,c,d,u=D._temp[0],p=D._temp[1],m=D._temp[2],f=D._temp[3];for(o=0;o<e.length;o++)(n=e[o]).isActive&&!n.isSensor&&(r=(i=n.collision).parentA,s=i.parentB,a=i.normal,l=D.sub(D.add(s.positionImpulse,s.position,u),D.add(r.positionImpulse,D.sub(s.position,i.penetration,p),m),f),n.separation=D.dot(a,l));for(o=0;o<e.length;o++)(n=e[o]).isActive&&!n.isSensor&&(r=(i=n.collision).parentA,s=i.parentB,a=i.normal,d=(n.separation-n.slop)*t,(r.isStatic||s.isStatic)&&(d*=2),r.isStatic||r.isSleeping||(c=W._positionDampen/r.totalContacts,r.positionImpulse.x+=a.x*d*c,r.positionImpulse.y+=a.y*d*c),s.isStatic||s.isSleeping||(c=W._positionDampen/s.totalContacts,s.positionImpulse.x-=a.x*d*c,s.positionImpulse.y-=a.y*d*c))},W.postSolvePosition=function(e){for(var t=0;t<e.length;t++){var o=e[t];if((o.totalContacts=0)!==o.positionImpulse.x||0!==o.positionImpulse.y){for(var n=0;n<o.parts.length;n++){var i=o.parts[n];r.translate(i.vertices,o.positionImpulse),s.update(i.bounds,i.vertices,o.velocity),i.position.x+=o.positionImpulse.x,i.position.y+=o.positionImpulse.y}o.positionPrev.x+=o.positionImpulse.x,o.positionPrev.y+=o.positionImpulse.y,D.dot(o.positionImpulse,o.velocity)<0?(o.positionImpulse.x=0,o.positionImpulse.y=0):(o.positionImpulse.x*=W._positionWarming,o.positionImpulse.y*=W._positionWarming)}}},W.preSolveVelocity=function(e){var t,o,n,i,r,s,a,l,c,d,u,p,m,f,v=D._temp[0],y=D._temp[1];for(t=0;t<e.length;t++)if((n=e[t]).isActive&&!n.isSensor)for(i=n.activeContacts,s=(r=n.collision).parentA,a=r.parentB,l=r.normal,c=r.tangent,o=0;o<i.length;o++)u=(d=i[o]).vertex,p=d.normalImpulse,m=d.tangentImpulse,0===p&&0===m||(v.x=l.x*p+c.x*m,v.y=l.y*p+c.y*m,s.isStatic||s.isSleeping||(f=D.sub(u,s.position,y),s.positionPrev.x+=v.x*s.inverseMass,s.positionPrev.y+=v.y*s.inverseMass,s.anglePrev+=D.cross(f,v)*s.inverseInertia),a.isStatic||a.isSleeping||(f=D.sub(u,a.position,y),a.positionPrev.x-=v.x*a.inverseMass,a.positionPrev.y-=v.y*a.inverseMass,a.anglePrev-=D.cross(f,v)*a.inverseInertia))},W.solveVelocity=function(e,t){for(var o=t*t,n=D._temp[0],i=D._temp[1],r=D._temp[2],s=D._temp[3],a=D._temp[4],l=D._temp[5],c=0;c<e.length;c++){var d=e[c];if(d.isActive&&!d.isSensor){var u=d.collision,p=u.parentA,m=u.parentB,f=u.normal,v=u.tangent,y=d.activeContacts,g=1/y.length;p.velocity.x=p.position.x-p.positionPrev.x,p.velocity.y=p.position.y-p.positionPrev.y,m.velocity.x=m.position.x-m.positionPrev.x,m.velocity.y=m.position.y-m.positionPrev.y,p.angularVelocity=p.angle-p.anglePrev,m.angularVelocity=m.angle-m.anglePrev;for(var x=0;x<y.length;x++){var h=y[x],b=h.vertex,w=D.sub(b,p.position,i),S=D.sub(b,m.position,r),C=D.add(p.velocity,D.mult(D.perp(w),p.angularVelocity),s),A=D.add(m.velocity,D.mult(D.perp(S),m.angularVelocity),a),P=D.sub(C,A,l),B=D.dot(f,P),M=D.dot(v,P),k=Math.abs(M),I=N.sign(M),_=(1+d.restitution)*B,T=N.clamp(d.separation+B,0,1)*W._frictionNormalMultiplier,R=M,V=1/0;k>d.friction*d.frictionStatic*T*o&&(V=k,R=N.clamp(d.friction*I*o,-V,V));var E=D.cross(w,f),L=D.cross(S,f),F=g/(p.inverseMass+m.inverseMass+p.inverseInertia*E*E+m.inverseInertia*L*L);if(_*=F,R*=F,B<0&&B*B>W._restingThresh*o)h.normalImpulse=0;else{var O=h.normalImpulse;h.normalImpulse=Math.min(h.normalImpulse+_,0),_=h.normalImpulse-O}if(M*M>W._restingThreshTangent*o)h.tangentImpulse=0;else{var q=h.tangentImpulse;h.tangentImpulse=N.clamp(h.tangentImpulse+R,-V,V),R=h.tangentImpulse-q}n.x=f.x*_+v.x*R,n.y=f.y*_+v.y*R,p.isStatic||p.isSleeping||(p.positionPrev.x+=n.x*p.inverseMass,p.positionPrev.y+=n.y*p.inverseMass,p.anglePrev+=D.cross(w,n)*p.inverseInertia),m.isStatic||m.isSleeping||(m.positionPrev.x-=n.x*m.inverseMass,m.positionPrev.y-=n.y*m.inverseMass,m.anglePrev-=D.cross(S,n)*m.inverseInertia)}}}}},{"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],11:[function(e,t,o){var g={};t.exports=g;var x=e("../geometry/Vertices"),h=e("../geometry/Vector");g.collides=function(e,t,o){var n,i,r,s,a=!1;if(o){var l=e.parent,c=t.parent,d=l.speed*l.speed+l.angularSpeed*l.angularSpeed+c.speed*c.speed+c.angularSpeed*c.angularSpeed;a=o&&o.collided&&d<.2,s=o}else s={collided:!1,bodyA:e,bodyB:t};if(o&&a){var u=s.axisBody,p=u===e?t:e,m=[u.axes[o.axisNumber]];if(r=g._overlapAxes(u.vertices,p.vertices,m),s.reused=!0,r.overlap<=0)return s.collided=!1,s}else{if((n=g._overlapAxes(e.vertices,t.vertices,e.axes)).overlap<=0)return s.collided=!1,s;if((i=g._overlapAxes(t.vertices,e.vertices,t.axes)).overlap<=0)return s.collided=!1,s;n.overlap<i.overlap?(r=n,s.axisBody=e):(r=i,s.axisBody=t),s.axisNumber=r.axisNumber}s.bodyA=e.id<t.id?e:t,s.bodyB=e.id<t.id?t:e,s.collided=!0,s.depth=r.overlap,s.parentA=s.bodyA.parent,s.parentB=s.bodyB.parent,e=s.bodyA,t=s.bodyB,h.dot(r.axis,h.sub(t.position,e.position))<0?s.normal={x:r.axis.x,y:r.axis.y}:s.normal={x:-r.axis.x,y:-r.axis.y},s.tangent=h.perp(s.normal),s.penetration=s.penetration||{},s.penetration.x=s.normal.x*s.depth,s.penetration.y=s.normal.y*s.depth;var f=g._findSupports(e,t,s.normal),v=[];if(x.contains(e.vertices,f[0])&&v.push(f[0]),x.contains(e.vertices,f[1])&&v.push(f[1]),v.length<2){var y=g._findSupports(t,e,h.neg(s.normal));x.contains(t.vertices,y[0])&&v.push(y[0]),v.length<2&&x.contains(t.vertices,y[1])&&v.push(y[1])}return v.length<1&&(v=[f[0]]),s.supports=v,s},g._overlapAxes=function(e,t,o){for(var n,i,r=h._temp[0],s=h._temp[1],a={overlap:Number.MAX_VALUE},l=0;l<o.length;l++){if(i=o[l],g._projectToAxis(r,e,i),g._projectToAxis(s,t,i),(n=Math.min(r.max-s.min,s.max-r.min))<=0)return a.overlap=n,a;n<a.overlap&&(a.overlap=n,a.axis=i,a.axisNumber=l)}return a},g._projectToAxis=function(e,t,o){for(var n=h.dot(t[0],o),i=n,r=1;r<t.length;r+=1){var s=h.dot(t[r],o);i<s?i=s:s<n&&(n=s)}e.min=n,e.max=i},g._findSupports=function(e,t,o){for(var n,i,r,s,a=Number.MAX_VALUE,l=h._temp[0],c=t.vertices,d=e.position,u=0;u<c.length;u++)i=c[u],l.x=i.x-d.x,l.y=i.y-d.y,(n=-h.dot(o,l))<a&&(a=n,r=i);return i=c[0<=r.index-1?r.index-1:c.length-1],l.x=i.x-d.x,l.y=i.y-d.y,a=-h.dot(o,l),s=i,i=c[(r.index+1)%c.length],l.x=i.x-d.x,l.y=i.y-d.y,(n=-h.dot(o,l))<a&&(s=i),[r,s]}},{"../geometry/Vector":28,"../geometry/Vertices":29}],12:[function(e,t,o){var w={};t.exports=w;var s=e("../geometry/Vertices"),S=e("../geometry/Vector"),a=e("../core/Sleeping"),l=e("../geometry/Bounds"),c=e("../geometry/Axes"),d=e("../core/Common");w._warming=.4,w._torqueDampen=1,w._minLength=1e-6,w.create=function(e){var t=e;t.bodyA&&!t.pointA&&(t.pointA={x:0,y:0}),t.bodyB&&!t.pointB&&(t.pointB={x:0,y:0});var o=t.bodyA?S.add(t.bodyA.position,t.pointA):t.pointA,n=t.bodyB?S.add(t.bodyB.position,t.pointB):t.pointB,i=S.magnitude(S.sub(o,n));t.length=void 0!==t.length?t.length:i,t.id=t.id||d.nextId(),t.label=t.label||"Constraint",t.type="constraint",t.stiffness=t.stiffness||(0<t.length?1:.7),t.damping=t.damping||0,t.angularStiffness=t.angularStiffness||0,t.angleA=t.bodyA?t.bodyA.angle:t.angleA,t.angleB=t.bodyB?t.bodyB.angle:t.angleB,t.plugin={};var r={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return 0===t.length&&.1<t.stiffness?(r.type="pin",r.anchors=!1):t.stiffness<.9&&(r.type="spring"),t.render=d.extend(r,t.render),t},w.preSolveAll=function(e){for(var t=0;t<e.length;t+=1){var o=e[t],n=o.constraintImpulse;o.isStatic||0===n.x&&0===n.y&&0===n.angle||(o.position.x+=n.x,o.position.y+=n.y,o.angle+=n.angle)}},w.solveAll=function(e,t){for(var o=0;o<e.length;o+=1){var n=e[o],i=!n.bodyA||n.bodyA&&n.bodyA.isStatic,r=!n.bodyB||n.bodyB&&n.bodyB.isStatic;(i||r)&&w.solve(e[o],t)}for(o=0;o<e.length;o+=1)i=!(n=e[o]).bodyA||n.bodyA&&n.bodyA.isStatic,r=!n.bodyB||n.bodyB&&n.bodyB.isStatic,i||r||w.solve(e[o],t)},w.solve=function(e,t){var o=e.bodyA,n=e.bodyB,i=e.pointA,r=e.pointB;if(o||n){o&&!o.isStatic&&(S.rotate(i,o.angle-e.angleA,i),e.angleA=o.angle),n&&!n.isStatic&&(S.rotate(r,n.angle-e.angleB,r),e.angleB=n.angle);var s=i,a=r;if(o&&(s=S.add(o.position,i)),n&&(a=S.add(n.position,r)),s&&a){var l=S.sub(s,a),c=S.magnitude(l);c<w._minLength&&(c=w._minLength);var d,u,p,m,f,v=(c-e.length)/c,y=e.stiffness<1?e.stiffness*t:e.stiffness,g=S.mult(l,v*y),x=(o?o.inverseMass:0)+(n?n.inverseMass:0),h=x+((o?o.inverseInertia:0)+(n?n.inverseInertia:0));if(e.damping){var b=S.create();p=S.div(l,c),f=S.sub(n&&S.sub(n.position,n.positionPrev)||b,o&&S.sub(o.position,o.positionPrev)||b),m=S.dot(p,f)}o&&!o.isStatic&&(u=o.inverseMass/x,o.constraintImpulse.x-=g.x*u,o.constraintImpulse.y-=g.y*u,o.position.x-=g.x*u,o.position.y-=g.y*u,e.damping&&(o.positionPrev.x-=e.damping*p.x*m*u,o.positionPrev.y-=e.damping*p.y*m*u),d=S.cross(i,g)/h*w._torqueDampen*o.inverseInertia*(1-e.angularStiffness),o.constraintImpulse.angle-=d,o.angle-=d),n&&!n.isStatic&&(u=n.inverseMass/x,n.constraintImpulse.x+=g.x*u,n.constraintImpulse.y+=g.y*u,n.position.x+=g.x*u,n.position.y+=g.y*u,e.damping&&(n.positionPrev.x+=e.damping*p.x*m*u,n.positionPrev.y+=e.damping*p.y*m*u),d=S.cross(r,g)/h*w._torqueDampen*n.inverseInertia*(1-e.angularStiffness),n.constraintImpulse.angle+=d,n.angle+=d)}}},w.postSolveAll=function(e){for(var t=0;t<e.length;t++){var o=e[t],n=o.constraintImpulse;if(!(o.isStatic||0===n.x&&0===n.y&&0===n.angle)){a.set(o,!1);for(var i=0;i<o.parts.length;i++){var r=o.parts[i];s.translate(r.vertices,n),0<i&&(r.position.x+=n.x,r.position.y+=n.y),0!==n.angle&&(s.rotate(r.vertices,n.angle,o.position),c.rotate(r.axes,n.angle),0<i&&S.rotateAbout(r.position,n.angle,o.position,r.position)),l.update(r.bounds,r.vertices,o.velocity)}n.angle*=w._warming,n.x*=w._warming,n.y*=w._warming}}}},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],13:[function(e,t,o){var r={};t.exports=r;var l=e("../geometry/Vertices"),c=e("../core/Sleeping"),s=e("../core/Mouse"),d=e("../core/Events"),u=e("../collision/Detector"),a=e("./Constraint"),p=e("../body/Composite"),m=e("../core/Common"),f=e("../geometry/Bounds");r.create=function(t,e){var o=(t?t.mouse:null)||(e?e.mouse:null);o||(t&&t.render&&t.render.canvas?o=s.create(t.render.canvas):e&&e.element?o=s.create(e.element):(o=s.create(),m.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var n={type:"mouseConstraint",mouse:o,element:null,body:null,constraint:a.create({label:"Mouse Constraint",pointA:o.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),collisionFilter:{category:1,mask:4294967295,group:0}},i=m.extend(n,e);return d.on(t,"beforeUpdate",function(){var e=p.allBodies(t.world);r.update(i,e),r._triggerEvents(i)}),i},r.update=function(e,t){var o=e.mouse,n=e.constraint,i=e.body;if(0===o.button){if(n.bodyB)c.set(n.bodyB,!1),n.pointA=o.position;else for(var r=0;r<t.length;r++)if(i=t[r],f.contains(i.bounds,o.position)&&u.canCollide(i.collisionFilter,e.collisionFilter))for(var s=1<i.parts.length?1:0;s<i.parts.length;s++){var a=i.parts[s];if(l.contains(a.vertices,o.position)){n.pointA=o.position,n.bodyB=e.body=i,n.pointB={x:o.position.x-i.position.x,y:o.position.y-i.position.y},n.angleB=i.angle,c.set(i,!1),d.trigger(e,"startdrag",{mouse:o,body:i});break}}}else n.bodyB=e.body=null,n.pointB=null,i&&d.trigger(e,"enddrag",{mouse:o,body:i})},r._triggerEvents=function(e){var t=e.mouse,o=t.sourceEvents;o.mousemove&&d.trigger(e,"mousemove",{mouse:t}),o.mousedown&&d.trigger(e,"mousedown",{mouse:t}),o.mouseup&&d.trigger(e,"mouseup",{mouse:t}),s.clearSourceEvents(t)}},{"../body/Composite":2,"../collision/Detector":5,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../core/Sleeping":22,"../geometry/Bounds":26,"../geometry/Vertices":29,"./Constraint":12}],14:[function(i,e,t){(function(n){var l={};e.exports=l,function(){l._nextId=0,l._seed=0,l._nowStartTime=+new Date,l.extend=function(e,t){var o,n;n="boolean"==typeof t?(o=2,t):(o=1,!0);for(var i=o;i<arguments.length;i++){var r=arguments[i];if(r)for(var s in r)n&&r[s]&&r[s].constructor===Object?e[s]&&e[s].constructor!==Object?e[s]=r[s]:(e[s]=e[s]||{},l.extend(e[s],n,r[s])):e[s]=r[s]}return e},l.clone=function(e,t){return l.extend({},t,e)},l.keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var o in e)t.push(o);return t},l.values=function(e){var t=[];if(Object.keys){for(var o=Object.keys(e),n=0;n<o.length;n++)t.push(e[o[n]]);return t}for(var i in e)t.push(e[i]);return t},l.get=function(e,t,o,n){t=t.split(".").slice(o,n);for(var i=0;i<t.length;i+=1)e=e[t[i]];return e},l.set=function(e,t,o,n,i){var r=t.split(".").slice(n,i);return l.get(e,t,0,-1)[r[r.length-1]]=o},l.shuffle=function(e){for(var t=e.length-1;0<t;t--){var o=Math.floor(l.random()*(t+1)),n=e[t];e[t]=e[o],e[o]=n}return e},l.choose=function(e){return e[Math.floor(l.random()*e.length)]},l.isElement=function(e){return"undefined"!=typeof HTMLElement?e instanceof HTMLElement:!!(e&&e.nodeType&&e.nodeName)},l.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},l.isFunction=function(e){return"function"==typeof e},l.isPlainObject=function(e){return"object"==typeof e&&e.constructor===Object},l.isString=function(e){return"[object String]"===toString.call(e)},l.clamp=function(e,t,o){return e<t?t:o<e?o:e},l.sign=function(e){return e<0?-1:1},l.now=function(){if(window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return new Date-l._nowStartTime},l.random=function(e,t){return t=void 0!==t?t:1,(e=void 0!==e?e:0)+o()*(t-e)};var o=function(){return l._seed=(9301*l._seed+49297)%233280,l._seed/233280};l.colorToNumber=function(e){return 3==(e=e.replace("#","")).length&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)),parseInt(e,16)},l.logLevel=1,l.log=function(){console&&0<l.logLevel&&l.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},l.info=function(){console&&0<l.logLevel&&l.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},l.warn=function(){console&&0<l.logLevel&&l.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},l.nextId=function(){return l._nextId++},l.indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var o=0;o<e.length;o++)if(e[o]===t)return o;return-1},l.map=function(e,t){if(e.map)return e.map(t);for(var o=[],n=0;n<e.length;n+=1)o.push(t(e[n]));return o},l.topologicalSort=function(e){var t=[],o=[],n=[];for(var i in e)o[i]||n[i]||l._topologicalSort(i,o,n,e,t);return t},l._topologicalSort=function(e,t,o,n,i){var r=n[e]||[];o[e]=!0;for(var s=0;s<r.length;s+=1){var a=r[s];o[a]||(t[a]||l._topologicalSort(a,t,o,n,i))}o[e]=!1,t[e]=!0,i.push(e)},l.chain=function(){for(var r=[],e=0;e<arguments.length;e+=1){var t=arguments[e];t._chained?r.push.apply(r,t._chained):r.push(t)}var o=function(){for(var e,t=new Array(arguments.length),o=0,n=arguments.length;o<n;o++)t[o]=arguments[o];for(o=0;o<r.length;o+=1){var i=r[o].apply(e,t);void 0!==i&&(e=i)}return e};return o._chained=r,o},l.chainPathBefore=function(e,t,o){return l.set(e,t,l.chain(o,l.get(e,t)))},l.chainPathAfter=function(e,t,o){return l.set(e,t,l.chain(l.get(e,t),o))},l._requireGlobal=function(e,t){return("undefined"!=typeof window?window[e]:void 0!==n?n[e]:null)||i(t)}}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],15:[function(e,t,o){var f={};t.exports=f;var r=e("../body/World"),v=e("./Sleeping"),y=e("../collision/Resolver"),s=e("../render/Render"),g=e("../collision/Pairs"),a=(e("./Metrics"),e("../collision/Grid")),x=e("./Events"),h=e("../body/Composite"),b=e("../constraint/Constraint"),l=e("./Common"),c=e("../body/Body");f.create=function(e,t){t=(t=l.isElement(e)?t:e)||{},((e=l.isElement(e)?e:null)||t.render)&&l.warn("Engine.create: engine.render is deprecated (see docs)");var o={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},timing:{timestamp:0,timeScale:1},broadphase:{controller:a}},n=l.extend(o,t);if(e||n.render){var i={element:e,controller:s};n.render=l.extend(i,n.render)}return n.render&&n.render.controller&&(n.render=n.render.controller.create(n.render)),n.render&&(n.render.engine=n),n.world=t.world||r.create(n.world),n.pairs=g.create(),n.broadphase=n.broadphase.controller.create(n.broadphase),n.metrics=n.metrics||{extended:!1},n},f.update=function(e,t,o){t=t||1e3/60,o=o||1;var n,i=e.world,r=e.timing,s=e.broadphase,a=[];r.timestamp+=t*r.timeScale;var l={timestamp:r.timestamp};x.trigger(e,"beforeUpdate",l);var c=h.allBodies(i),d=h.allConstraints(i);for(e.enableSleeping&&v.update(c,r.timeScale),f._bodiesApplyGravity(c,i.gravity),f._bodiesUpdate(c,t,r.timeScale,o,i.bounds),b.preSolveAll(c),n=0;n<e.constraintIterations;n++)b.solveAll(d,r.timeScale);b.postSolveAll(c),a=s.controller?(i.isModified&&s.controller.clear(s),s.controller.update(s,c,e,i.isModified),s.pairsList):c,i.isModified&&h.setModified(i,!1,!1,!0);var u=s.detector(a,e),p=e.pairs,m=r.timestamp;for(g.update(p,u,m),g.removeOld(p,m),e.enableSleeping&&v.afterCollisions(p.list,r.timeScale),0<p.collisionStart.length&&x.trigger(e,"collisionStart",{pairs:p.collisionStart}),y.preSolvePosition(p.list),n=0;n<e.positionIterations;n++)y.solvePosition(p.list,r.timeScale);for(y.postSolvePosition(c),b.preSolveAll(c),n=0;n<e.constraintIterations;n++)b.solveAll(d,r.timeScale);for(b.postSolveAll(c),y.preSolveVelocity(p.list),n=0;n<e.velocityIterations;n++)y.solveVelocity(p.list,r.timeScale);return 0<p.collisionActive.length&&x.trigger(e,"collisionActive",{pairs:p.collisionActive}),0<p.collisionEnd.length&&x.trigger(e,"collisionEnd",{pairs:p.collisionEnd}),f._bodiesClearForces(c),x.trigger(e,"afterUpdate",l),e},f.merge=function(e,t){if(l.extend(e,t),t.world){e.world=t.world,f.clear(e);for(var o=h.allBodies(e.world),n=0;n<o.length;n++){var i=o[n];v.set(i,!1),i.id=l.nextId()}}},f.clear=function(e){var t=e.world;g.clear(e.pairs);var o=e.broadphase;if(o.controller){var n=h.allBodies(t);o.controller.clear(o),o.controller.update(o,n,e,!0)}},f._bodiesClearForces=function(e){for(var t=0;t<e.length;t++){var o=e[t];o.force.x=0,o.force.y=0,o.torque=0}},f._bodiesApplyGravity=function(e,t){var o=void 0!==t.scale?t.scale:.001;if((0!==t.x||0!==t.y)&&0!==o)for(var n=0;n<e.length;n++){var i=e[n];i.isStatic||i.isSleeping||(i.force.y+=i.mass*t.y*o,i.force.x+=i.mass*t.x*o)}},f._bodiesUpdate=function(e,t,o,n,i){for(var r=0;r<e.length;r++){var s=e[r];s.isStatic||s.isSleeping||c.update(s,t,o,n)}}},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Grid":6,"../collision/Pairs":8,"../collision/Resolver":10,"../constraint/Constraint":12,"../render/Render":31,"./Common":14,"./Events":16,"./Metrics":18,"./Sleeping":22}],16:[function(e,t,o){var n={};t.exports=n;var c=e("./Common");n.on=function(e,t,o){for(var n,i=t.split(" "),r=0;r<i.length;r++)n=i[r],e.events=e.events||{},e.events[n]=e.events[n]||[],e.events[n].push(o);return o},n.off=function(e,t,o){if(t){"function"==typeof t&&(o=t,t=c.keys(e.events).join(" "));for(var n=t.split(" "),i=0;i<n.length;i++){var r=e.events[n[i]],s=[];if(o&&r)for(var a=0;a<r.length;a++)r[a]!==o&&s.push(r[a]);e.events[n[i]]=s}}else e.events={}},n.trigger=function(e,t,o){var n,i,r,s;if(e.events){o||(o={}),n=t.split(" ");for(var a=0;a<n.length;a++)if(i=n[a],r=e.events[i]){(s=c.clone(o,!1)).name=i,s.source=e;for(var l=0;l<r.length;l++)r[l].apply(e,[s])}}}},{"./Common":14}],17:[function(e,t,o){var n={};t.exports=n;var i=e("./Plugin"),r=e("./Common");n.name="matter-js",n.version="0.14.2",n.uses=[],n.used=[],n.use=function(){i.use(n,Array.prototype.slice.call(arguments))},n.before=function(e,t){return e=e.replace(/^Matter./,""),r.chainPathBefore(n,e,t)},n.after=function(e,t){return e=e.replace(/^Matter./,""),r.chainPathAfter(n,e,t)}},{"./Common":14,"./Plugin":20}],18:[function(e,t,o){},{"../body/Composite":2,"./Common":14}],19:[function(e,t,o){var n={};t.exports=n;var i=e("../core/Common");n.create=function(e){var o={};return e||i.log("Mouse.create: element was undefined, defaulting to document.body","warn"),o.element=e||document.body,o.absolute={x:0,y:0},o.position={x:0,y:0},o.mousedownPosition={x:0,y:0},o.mouseupPosition={x:0,y:0},o.offset={x:0,y:0},o.scale={x:1,y:1},o.wheelDelta=0,o.button=-1,o.pixelRatio=o.element.getAttribute("data-pixel-ratio")||1,o.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},o.mousemove=function(e){var t=n._getRelativeMousePosition(e,o.element,o.pixelRatio);e.changedTouches&&(o.button=0,e.preventDefault()),o.absolute.x=t.x,o.absolute.y=t.y,o.position.x=o.absolute.x*o.scale.x+o.offset.x,o.position.y=o.absolute.y*o.scale.y+o.offset.y,o.sourceEvents.mousemove=e},o.mousedown=function(e){var t=n._getRelativeMousePosition(e,o.element,o.pixelRatio);e.changedTouches?(o.button=0,e.preventDefault()):o.button=e.button,o.absolute.x=t.x,o.absolute.y=t.y,o.position.x=o.absolute.x*o.scale.x+o.offset.x,o.position.y=o.absolute.y*o.scale.y+o.offset.y,o.mousedownPosition.x=o.position.x,o.mousedownPosition.y=o.position.y,o.sourceEvents.mousedown=e},o.mouseup=function(e){var t=n._getRelativeMousePosition(e,o.element,o.pixelRatio);e.changedTouches&&e.preventDefault(),o.button=-1,o.absolute.x=t.x,o.absolute.y=t.y,o.position.x=o.absolute.x*o.scale.x+o.offset.x,o.position.y=o.absolute.y*o.scale.y+o.offset.y,o.mouseupPosition.x=o.position.x,o.mouseupPosition.y=o.position.y,o.sourceEvents.mouseup=e},o.mousewheel=function(e){o.wheelDelta=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail)),e.preventDefault()},n.setElement(o,o.element),o},n.setElement=function(e,t){(e.element=t).addEventListener("mousemove",e.mousemove),t.addEventListener("mousedown",e.mousedown),t.addEventListener("mouseup",e.mouseup),t.addEventListener("mousewheel",e.mousewheel),t.addEventListener("DOMMouseScroll",e.mousewheel),t.addEventListener("touchmove",e.mousemove),t.addEventListener("touchstart",e.mousedown),t.addEventListener("touchend",e.mouseup)},n.clearSourceEvents=function(e){e.sourceEvents.mousemove=null,e.sourceEvents.mousedown=null,e.sourceEvents.mouseup=null,e.sourceEvents.mousewheel=null,e.wheelDelta=0},n.setOffset=function(e,t){e.offset.x=t.x,e.offset.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},n.setScale=function(e,t){e.scale.x=t.x,e.scale.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},n._getRelativeMousePosition=function(e,t,o){var n,i,r=t.getBoundingClientRect(),s=document.documentElement||document.body.parentNode||document.body,a=void 0!==window.pageXOffset?window.pageXOffset:s.scrollLeft,l=void 0!==window.pageYOffset?window.pageYOffset:s.scrollTop,c=e.changedTouches;return i=c?(n=c[0].pageX-r.left-a,c[0].pageY-r.top-l):(n=e.pageX-r.left-a,e.pageY-r.top-l),{x:n/(t.clientWidth/(t.width||t.clientWidth)*o),y:i/(t.clientHeight/(t.height||t.clientHeight)*o)}}},{"../core/Common":14}],20:[function(e,t,o){var a={};t.exports=a;var l=e("./Common");a._registry={},a.register=function(e){if(a.isPlugin(e)||l.warn("Plugin.register:",a.toString(e),"does not implement all required fields."),e.name in a._registry){var t=a._registry[e.name],o=a.versionParse(e.version).number,n=a.versionParse(t.version).number;n<o?(l.warn("Plugin.register:",a.toString(t),"was upgraded to",a.toString(e)),a._registry[e.name]=e):o<n?l.warn("Plugin.register:",a.toString(t),"can not be downgraded to",a.toString(e)):e!==t&&l.warn("Plugin.register:",a.toString(e),"is already registered to different plugin object")}else a._registry[e.name]=e;return e},a.resolve=function(e){return a._registry[a.dependencyParse(e).name]},a.toString=function(e){return"string"==typeof e?e:(e.name||"anonymous")+"@"+(e.version||e.range||"0.0.0")},a.isPlugin=function(e){return e&&e.name&&e.version&&e.install},a.isUsed=function(e,t){return-1<e.used.indexOf(t)},a.isFor=function(e,t){var o=e.for&&a.dependencyParse(e.for);return!e.for||t.name===o.name&&a.versionSatisfies(t.version,o.range)},a.use=function(e,t){if(e.uses=(e.uses||[]).concat(t||[]),0!==e.uses.length){for(var o=a.dependencies(e),n=l.topologicalSort(o),i=[],r=0;r<n.length;r+=1)if(n[r]!==e.name){var s=a.resolve(n[r]);s?a.isUsed(e,s.name)||(a.isFor(s,e)||(l.warn("Plugin.use:",a.toString(s),"is for",s.for,"but installed on",a.toString(e)+"."),s._warned=!0),s.install?s.install(e):(l.warn("Plugin.use:",a.toString(s),"does not specify an install function."),s._warned=!0),s._warned?(i.push("ðŸ”¶ "+a.toString(s)),delete s._warned):i.push("âœ… "+a.toString(s)),e.used.push(s.name)):i.push("âŒ "+n[r])}0<i.length&&l.info(i.join("  "))}else l.warn("Plugin.use:",a.toString(e),"does not specify any dependencies to install.")},a.dependencies=function(n,e){var i=a.dependencyParse(n),t=i.name;if(!(t in(e=e||{}))){n=a.resolve(n)||n,e[t]=l.map(n.uses||[],function(e){a.isPlugin(e)&&a.register(e);var t=a.dependencyParse(e),o=a.resolve(e);return o&&!a.versionSatisfies(o.version,t.range)?(l.warn("Plugin.dependencies:",a.toString(o),"does not satisfy",a.toString(t),"used by",a.toString(i)+"."),o._warned=!0,n._warned=!0):o||(l.warn("Plugin.dependencies:",a.toString(e),"used by",a.toString(i),"could not be resolved."),n._warned=!0),t.name});for(var o=0;o<e[t].length;o+=1)a.dependencies(e[t][o],e);return e}},a.dependencyParse=function(e){return l.isString(e)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?))?$/.test(e)||l.warn("Plugin.dependencyParse:",e,"is not a valid dependency string."),{name:e.split("@")[0],range:e.split("@")[1]||"*"}):{name:e.name,range:e.range||e.version}},a.versionParse=function(e){/^\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?$/.test(e)||l.warn("Plugin.versionParse:",e,"is not a valid version or range.");var t=e.split("-");e=t[0];var o=isNaN(Number(e[0])),n=o?e.substr(1):e,i=l.map(n.split("."),function(e){return Number(e)});return{isRange:o,version:n,range:e,operator:o?e[0]:"",parts:i,prerelease:t[1],number:1e8*i[0]+1e4*i[1]+i[2]}},a.versionSatisfies=function(e,t){t=t||"*";var o=a.versionParse(t),n=o.parts,i=a.versionParse(e),r=i.parts;if(o.isRange){if("*"===o.operator||"*"===e)return!0;if("~"===o.operator)return r[0]===n[0]&&r[1]===n[1]&&r[2]>=n[2];if("^"===o.operator)return 0<n[0]?r[0]===n[0]&&i.number>=o.number:0<n[1]?r[1]===n[1]&&r[2]>=n[2]:r[2]===n[2]}return e===t||"*"===e}},{"./Common":14}],21:[function(e,t,o){var r={};t.exports=r;var a=e("./Events"),l=e("./Engine"),n=e("./Common");!function(){var i,t,o;("undefined"!=typeof window&&(i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),i)||(i=function(e){o=setTimeout(function(){e(n.now())},1e3/60)},t=function(){clearTimeout(o)});r.create=function(e){var t=n.extend({fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},e);return t.delta=t.delta||1e3/t.fps,t.deltaMin=t.deltaMin||1e3/t.fps,t.deltaMax=t.deltaMax||1e3/(.5*t.fps),t.fps=1e3/t.delta,t},r.run=function(o,n){return void 0!==o.positionIterations&&(n=o,o=r.create()),function e(t){o.frameRequestId=i(e),t&&o.enabled&&r.tick(o,n,t)}(),o},r.tick=function(e,t,o){var n,i=t.timing,r=1,s={timestamp:i.timestamp};a.trigger(e,"beforeTick",s),a.trigger(t,"beforeTick",s),e.isFixed?n=e.delta:(n=o-e.timePrev||e.delta,e.timePrev=o,e.deltaHistory.push(n),e.deltaHistory=e.deltaHistory.slice(-e.deltaSampleSize),r=(n=(n=(n=Math.min.apply(null,e.deltaHistory))<e.deltaMin?e.deltaMin:n)>e.deltaMax?e.deltaMax:n)/e.delta,e.delta=n),0!==e.timeScalePrev&&(r*=i.timeScale/e.timeScalePrev),0===i.timeScale&&(r=0),e.timeScalePrev=i.timeScale,e.correction=r,e.frameCounter+=1,1e3<=o-e.counterTimestamp&&(e.fps=e.frameCounter*((o-e.counterTimestamp)/1e3),e.counterTimestamp=o,e.frameCounter=0),a.trigger(e,"tick",s),a.trigger(t,"tick",s),t.world.isModified&&t.render&&t.render.controller&&t.render.controller.clear&&t.render.controller.clear(t.render),a.trigger(e,"beforeUpdate",s),l.update(t,n,r),a.trigger(e,"afterUpdate",s),t.render&&t.render.controller&&(a.trigger(e,"beforeRender",s),a.trigger(t,"beforeRender",s),t.render.controller.world(t.render),a.trigger(e,"afterRender",s),a.trigger(t,"afterRender",s)),a.trigger(e,"afterTick",s),a.trigger(t,"afterTick",s)},r.stop=function(e){t(e.frameRequestId)},r.start=function(e,t){r.run(e,t)}}()},{"./Common":14,"./Engine":15,"./Events":16}],22:[function(e,t,o){var d={};t.exports=d;var n=e("./Events");d._motionWakeThreshold=.18,d._motionSleepThreshold=.08,d._minBias=.9,d.update=function(e,t){for(var o=t*t*t,n=0;n<e.length;n++){var i=e[n],r=i.speed*i.speed+i.angularSpeed*i.angularSpeed;if(0===i.force.x&&0===i.force.y){var s=Math.min(i.motion,r),a=Math.max(i.motion,r);i.motion=d._minBias*s+(1-d._minBias)*a,0<i.sleepThreshold&&i.motion<d._motionSleepThreshold*o?(i.sleepCounter+=1,i.sleepCounter>=i.sleepThreshold&&d.set(i,!0)):0<i.sleepCounter&&(i.sleepCounter-=1)}else d.set(i,!1)}},d.afterCollisions=function(e,t){for(var o=t*t*t,n=0;n<e.length;n++){var i=e[n];if(i.isActive){var r=i.collision,s=r.bodyA.parent,a=r.bodyB.parent;if(!(s.isSleeping&&a.isSleeping||s.isStatic||a.isStatic)&&(s.isSleeping||a.isSleeping)){var l=s.isSleeping&&!s.isStatic?s:a,c=l===s?a:s;!l.isStatic&&c.motion>d._motionWakeThreshold*o&&d.set(l,!1)}}}},d.set=function(e,t){var o=e.isSleeping;t?(e.isSleeping=!0,e.sleepCounter=e.sleepThreshold,e.positionImpulse.x=0,e.positionImpulse.y=0,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.anglePrev=e.angle,e.speed=0,e.angularSpeed=0,e.motion=0,o||n.trigger(e,"sleepStart")):(e.isSleeping=!1,e.sleepCounter=0,o&&n.trigger(e,"sleepEnd"))}},{"./Events":16}],23:[function(e,t,o){var f={};t.exports=f;var P,B=e("../geometry/Vertices"),M=e("../core/Common"),k=e("../body/Body"),I=e("../geometry/Bounds"),_=e("../geometry/Vector");f.rectangle=function(e,t,o,n,i){i=i||{};var r={label:"Rectangle Body",position:{x:e,y:t},vertices:B.fromPath("L 0 0 L "+o+" 0 L "+o+" "+n+" L 0 "+n)};if(i.chamfer){var s=i.chamfer;r.vertices=B.chamfer(r.vertices,s.radius,s.quality,s.qualityMin,s.qualityMax),delete i.chamfer}return k.create(M.extend({},r,i))},f.trapezoid=function(e,t,o,n,i,r){r=r||{};var s,a=o*(i*=.5),l=a+(1-2*i)*o,c=l+a;s=i<.5?"L 0 0 L "+a+" "+-n+" L "+l+" "+-n+" L "+c+" 0":"L 0 0 L "+l+" "+-n+" L "+c+" 0";var d={label:"Trapezoid Body",position:{x:e,y:t},vertices:B.fromPath(s)};if(r.chamfer){var u=r.chamfer;d.vertices=B.chamfer(d.vertices,u.radius,u.quality,u.qualityMin,u.qualityMax),delete r.chamfer}return k.create(M.extend({},d,r))},f.circle=function(e,t,o,n,i){n=n||{};var r={label:"Circle Body",circleRadius:o};i=i||25;var s=Math.ceil(Math.max(10,Math.min(i,o)));return s%2==1&&(s+=1),f.polygon(e,t,s,o,M.extend({},r,n))},f.polygon=function(e,t,o,n,i){if(i=i||{},o<3)return f.circle(e,t,n,i);for(var r=2*Math.PI/o,s="",a=.5*r,l=0;l<o;l+=1){var c=a+l*r,d=Math.cos(c)*n,u=Math.sin(c)*n;s+="L "+d.toFixed(3)+" "+u.toFixed(3)+" "}var p={label:"Polygon Body",position:{x:e,y:t},vertices:B.fromPath(s)};if(i.chamfer){var m=i.chamfer;p.vertices=B.chamfer(p.vertices,m.radius,m.quality,m.qualityMin,m.qualityMax),delete i.chamfer}return k.create(M.extend({},p,i))},f.fromVertices=function(e,t,o,n,i,r,s){var a,l,c,d,u,p,m,f,v;for(P||(P=M._requireGlobal("decomp","poly-decomp")),n=n||{},l=[],i=void 0!==i&&i,r=void 0!==r?r:.01,s=void 0!==s?s:10,P||M.warn("Bodies.fromVertices: poly-decomp.js required. Could not decompose vertices. Fallback to convex hull."),M.isArray(o[0])||(o=[o]),f=0;f<o.length;f+=1)if(d=o[f],(c=B.isConvex(d))||!P)d=c?B.clockwiseSort(d):B.hull(d),l.push({position:{x:e,y:t},vertices:d});else{var y=d.map(function(e){return[e.x,e.y]});P.makeCCW(y),!1!==r&&P.removeCollinearPoints(y,r);var g=P.quickDecomp(y);for(u=0;u<g.length;u++){var x=g[u].map(function(e){return{x:e[0],y:e[1]}});0<s&&B.area(x)<s||l.push({position:B.centre(x),vertices:x})}}for(u=0;u<l.length;u++)l[u]=k.create(M.extend(l[u],n));if(i)for(u=0;u<l.length;u++){var h=l[u];for(p=u+1;p<l.length;p++){var b=l[p];if(I.overlaps(h.bounds,b.bounds)){var w=h.vertices,S=b.vertices;for(m=0;m<h.vertices.length;m++)for(v=0;v<b.vertices.length;v++){var C=_.magnitudeSquared(_.sub(w[(m+1)%w.length],S[v])),A=_.magnitudeSquared(_.sub(w[m],S[(v+1)%S.length]));C<5&&A<5&&(w[m].isInternal=!0,S[v].isInternal=!0)}}}}return 1<l.length?(a=k.create(M.extend({parts:l.slice(0)},n)),k.setPosition(a,{x:e,y:t}),a):l[0]}},{"../body/Body":1,"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],24:[function(e,t,o){var m={};t.exports=m;var x=e("../body/Composite"),v=e("../constraint/Constraint"),y=e("../core/Common"),h=e("../body/Body"),f=e("./Bodies");m.stack=function(e,t,o,n,i,r,s){for(var a,l=x.create({label:"Stack"}),c=e,d=t,u=0,p=0;p<n;p++){for(var m=0,f=0;f<o;f++){var v=s(c,d,f,p,a,u);if(v){var y=v.bounds.max.y-v.bounds.min.y,g=v.bounds.max.x-v.bounds.min.x;m<y&&(m=y),h.translate(v,{x:.5*g,y:.5*y}),c=v.bounds.max.x+i,x.addBody(l,v),a=v,u+=1}else c+=i}d+=m+r,c=e}return l},m.chain=function(e,t,o,n,i,r){for(var s=e.bodies,a=1;a<s.length;a++){var l=s[a-1],c=s[a],d=l.bounds.max.y-l.bounds.min.y,u=l.bounds.max.x-l.bounds.min.x,p=c.bounds.max.y-c.bounds.min.y,m={bodyA:l,pointA:{x:u*t,y:d*o},bodyB:c,pointB:{x:(c.bounds.max.x-c.bounds.min.x)*n,y:p*i}},f=y.extend(m,r);x.addConstraint(e,v.create(f))}return e.label+=" Chain",e},m.mesh=function(e,t,o,n,i){var r,s,a,l,c,d=e.bodies;for(r=0;r<o;r++){for(s=1;s<t;s++)a=d[s-1+r*t],l=d[s+r*t],x.addConstraint(e,v.create(y.extend({bodyA:a,bodyB:l},i)));if(0<r)for(s=0;s<t;s++)a=d[s+(r-1)*t],l=d[s+r*t],x.addConstraint(e,v.create(y.extend({bodyA:a,bodyB:l},i))),n&&0<s&&(c=d[s-1+(r-1)*t],x.addConstraint(e,v.create(y.extend({bodyA:c,bodyB:l},i)))),n&&s<t-1&&(c=d[s+1+(r-1)*t],x.addConstraint(e,v.create(y.extend({bodyA:c,bodyB:l},i))))}return e.label+=" Mesh",e},m.pyramid=function(l,e,c,d,u,t,p){return m.stack(l,e,c,d,u,t,function(e,t,o,n,i,r){var s=Math.min(d,Math.ceil(c/2)),a=i?i.bounds.max.x-i.bounds.min.x:0;if(!(s<n||o<(n=s-n)||c-1-n<o))return 1===r&&h.translate(i,{x:(o+(c%2==1?1:-1))*a,y:0}),p(l+(i?o*a:0)+o*u,t,o,n,i,r)})},m.newtonsCradle=function(e,t,o,n,i){for(var r=x.create({label:"Newtons Cradle"}),s=0;s<o;s++){var a=f.circle(e+s*(1.9*n),t+i,n,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),l=v.create({pointA:{x:e+s*(1.9*n),y:t},bodyB:a});x.addBody(r,a),x.addConstraint(r,l)}return r},m.car=function(e,t,o,n,i){var r=h.nextGroup(!0),s=.5*-o+20,a=.5*o-20,l=x.create({label:"Car"}),c=f.rectangle(e,t,o,n,{collisionFilter:{group:r},chamfer:{radius:.5*n},density:2e-4}),d=f.circle(e+s,t+0,i,{collisionFilter:{group:r},friction:.8}),u=f.circle(e+a,t+0,i,{collisionFilter:{group:r},friction:.8}),p=v.create({bodyB:c,pointB:{x:s,y:0},bodyA:d,stiffness:1,length:0}),m=v.create({bodyB:c,pointB:{x:a,y:0},bodyA:u,stiffness:1,length:0});return x.addBody(l,c),x.addBody(l,d),x.addBody(l,u),x.addConstraint(l,p),x.addConstraint(l,m),l},m.softBody=function(e,t,o,n,i,r,s,a,l,c){l=y.extend({inertia:1/0},l),c=y.extend({stiffness:.2,render:{type:"line",anchors:!1}},c);var d=m.stack(e,t,o,n,i,r,function(e,t){return f.circle(e,t,a,l)});return m.mesh(d,o,n,s,c),d.label="Soft Body",d}},{"../body/Body":1,"../body/Composite":2,"../constraint/Constraint":12,"../core/Common":14,"./Bodies":23}],25:[function(e,t,o){var n={};t.exports=n;var s=e("../geometry/Vector"),a=e("../core/Common");n.fromVertices=function(e){for(var t={},o=0;o<e.length;o++){var n=(o+1)%e.length,i=s.normalise({x:e[n].y-e[o].y,y:e[o].x-e[n].x}),r=0===i.y?1/0:i.x/i.y;t[r=r.toFixed(3).toString()]=i}return a.values(t)},n.rotate=function(e,t){if(0!==t)for(var o=Math.cos(t),n=Math.sin(t),i=0;i<e.length;i++){var r,s=e[i];r=s.x*o-s.y*n,s.y=s.x*n+s.y*o,s.x=r}}},{"../core/Common":14,"../geometry/Vector":28}],26:[function(e,t,o){var n={};(t.exports=n).create=function(e){var t={min:{x:0,y:0},max:{x:0,y:0}};return e&&n.update(t,e),t},n.update=function(e,t,o){e.min.x=1/0,e.max.x=-1/0,e.min.y=1/0,e.max.y=-1/0;for(var n=0;n<t.length;n++){var i=t[n];i.x>e.max.x&&(e.max.x=i.x),i.x<e.min.x&&(e.min.x=i.x),i.y>e.max.y&&(e.max.y=i.y),i.y<e.min.y&&(e.min.y=i.y)}o&&(0<o.x?e.max.x+=o.x:e.min.x+=o.x,0<o.y?e.max.y+=o.y:e.min.y+=o.y)},n.contains=function(e,t){return t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y},n.overlaps=function(e,t){return e.min.x<=t.max.x&&e.max.x>=t.min.x&&e.max.y>=t.min.y&&e.min.y<=t.max.y},n.translate=function(e,t){e.min.x+=t.x,e.max.x+=t.x,e.min.y+=t.y,e.max.y+=t.y},n.shift=function(e,t){var o=e.max.x-e.min.x,n=e.max.y-e.min.y;e.min.x=t.x,e.max.x=t.x+o,e.min.y=t.y,e.max.y=t.y+n}},{}],27:[function(e,t,o){var h={};t.exports=h;e("../geometry/Bounds");var b=e("../core/Common");h.pathToVertices=function(e,t){"undefined"==typeof window||"SVGPathSeg"in window||b.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var o,n,i,r,s,a,l,c,d,u,p,m=[],f=0,v=0,y=0;t=t||15;var g=function(e,t,o){var n=o%2==1&&1<o;if(!d||e!=d.x||t!=d.y){p=d&&n?(u=d.x,d.y):u=0;var i={x:u+e,y:p+t};!n&&d||(d=i),m.push(i),v=u+e,y=p+t}},x=function(e){var t=e.pathSegTypeAsLetter.toUpperCase();if("Z"!==t){switch(t){case"M":case"L":case"T":case"C":case"S":case"Q":v=e.x,y=e.y;break;case"H":v=e.x;break;case"V":y=e.y}g(v,y,e.pathSegType)}};for(h._svgPathToAbsolute(e),i=e.getTotalLength(),a=[],o=0;o<e.pathSegList.numberOfItems;o+=1)a.push(e.pathSegList.getItem(o));for(l=a.concat();f<i;){if((s=a[e.getPathSegAtLength(f)])!=c){for(;l.length&&l[0]!=s;)x(l.shift());c=s}switch(s.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":r=e.getPointAtLength(f),g(r.x,r.y,0)}f+=t}for(o=0,n=l.length;o<n;++o)x(l[o]);return m},h._svgPathToAbsolute=function(e){for(var t,o,n,i,r,s,a=e.pathSegList,l=0,c=0,d=a.numberOfItems,u=0;u<d;++u){var p=a.getItem(u),m=p.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(m))"x"in p&&(l=p.x),"y"in p&&(c=p.y);else switch("x1"in p&&(n=l+p.x1),"x2"in p&&(r=l+p.x2),"y1"in p&&(i=c+p.y1),"y2"in p&&(s=c+p.y2),"x"in p&&(l+=p.x),"y"in p&&(c+=p.y),m){case"m":a.replaceItem(e.createSVGPathSegMovetoAbs(l,c),u);break;case"l":a.replaceItem(e.createSVGPathSegLinetoAbs(l,c),u);break;case"h":a.replaceItem(e.createSVGPathSegLinetoHorizontalAbs(l),u);break;case"v":a.replaceItem(e.createSVGPathSegLinetoVerticalAbs(c),u);break;case"c":a.replaceItem(e.createSVGPathSegCurvetoCubicAbs(l,c,n,i,r,s),u);break;case"s":a.replaceItem(e.createSVGPathSegCurvetoCubicSmoothAbs(l,c,r,s),u);break;case"q":a.replaceItem(e.createSVGPathSegCurvetoQuadraticAbs(l,c,n,i),u);break;case"t":a.replaceItem(e.createSVGPathSegCurvetoQuadraticSmoothAbs(l,c),u);break;case"a":a.replaceItem(e.createSVGPathSegArcAbs(l,c,p.r1,p.r2,p.angle,p.largeArcFlag,p.sweepFlag),u);break;case"z":case"Z":l=t,c=o}"M"!=m&&"m"!=m||(t=l,o=c)}}},{"../core/Common":14,"../geometry/Bounds":26}],28:[function(e,t,o){var n={};(t.exports=n).create=function(e,t){return{x:e||0,y:t||0}},n.clone=function(e){return{x:e.x,y:e.y}},n.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},n.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},n.rotate=function(e,t,o){var n=Math.cos(t),i=Math.sin(t);o||(o={});var r=e.x*n-e.y*i;return o.y=e.x*i+e.y*n,o.x=r,o},n.rotateAbout=function(e,t,o,n){var i=Math.cos(t),r=Math.sin(t);n||(n={});var s=o.x+((e.x-o.x)*i-(e.y-o.y)*r);return n.y=o.y+((e.x-o.x)*r+(e.y-o.y)*i),n.x=s,n},n.normalise=function(e){var t=n.magnitude(e);return 0===t?{x:0,y:0}:{x:e.x/t,y:e.y/t}},n.dot=function(e,t){return e.x*t.x+e.y*t.y},n.cross=function(e,t){return e.x*t.y-e.y*t.x},n.cross3=function(e,t,o){return(t.x-e.x)*(o.y-e.y)-(t.y-e.y)*(o.x-e.x)},n.add=function(e,t,o){return o||(o={}),o.x=e.x+t.x,o.y=e.y+t.y,o},n.sub=function(e,t,o){return o||(o={}),o.x=e.x-t.x,o.y=e.y-t.y,o},n.mult=function(e,t){return{x:e.x*t,y:e.y*t}},n.div=function(e,t){return{x:e.x/t,y:e.y/t}},n.perp=function(e,t){return{x:(t=!0===t?-1:1)*-e.y,y:t*e.x}},n.neg=function(e){return{x:-e.x,y:-e.y}},n.angle=function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},n._temp=[n.create(),n.create(),n.create(),n.create(),n.create(),n.create()]},{}],29:[function(e,t,o){var a={};t.exports=a;var b=e("../geometry/Vector"),w=e("../core/Common");a.create=function(e,t){for(var o=[],n=0;n<e.length;n++){var i=e[n],r={x:i.x,y:i.y,index:n,body:t,isInternal:!1};o.push(r)}return o},a.fromPath=function(e,t){var n=[];return e.replace(/L?\s*([\-\d\.e]+)[\s,]*([\-\d\.e]+)*/gi,function(e,t,o){n.push({x:parseFloat(t),y:parseFloat(o)})}),a.create(n,t)},a.centre=function(e){for(var t,o,n,i=a.area(e,!0),r={x:0,y:0},s=0;s<e.length;s++)n=(s+1)%e.length,t=b.cross(e[s],e[n]),o=b.mult(b.add(e[s],e[n]),t),r=b.add(r,o);return b.div(r,6*i)},a.mean=function(e){for(var t={x:0,y:0},o=0;o<e.length;o++)t.x+=e[o].x,t.y+=e[o].y;return b.div(t,e.length)},a.area=function(e,t){for(var o=0,n=e.length-1,i=0;i<e.length;i++)o+=(e[n].x-e[i].x)*(e[n].y+e[i].y),n=i;return t?o/2:Math.abs(o)/2},a.inertia=function(e,t){for(var o,n,i=0,r=0,s=e,a=0;a<s.length;a++)n=(a+1)%s.length,i+=(o=Math.abs(b.cross(s[n],s[a])))*(b.dot(s[n],s[n])+b.dot(s[n],s[a])+b.dot(s[a],s[a])),r+=o;return t/6*(i/r)},a.translate=function(e,t,o){var n;if(o)for(n=0;n<e.length;n++)e[n].x+=t.x*o,e[n].y+=t.y*o;else for(n=0;n<e.length;n++)e[n].x+=t.x,e[n].y+=t.y;return e},a.rotate=function(e,t,o){if(0!==t){for(var n=Math.cos(t),i=Math.sin(t),r=0;r<e.length;r++){var s=e[r],a=s.x-o.x,l=s.y-o.y;s.x=o.x+(a*n-l*i),s.y=o.y+(a*i+l*n)}return e}},a.contains=function(e,t){for(var o=0;o<e.length;o++){var n=e[o],i=e[(o+1)%e.length];if(0<(t.x-n.x)*(i.y-n.y)+(t.y-n.y)*(n.x-i.x))return!1}return!0},a.scale=function(e,t,o,n){if(1===t&&1===o)return e;var i,r;n=n||a.centre(e);for(var s=0;s<e.length;s++)i=e[s],r=b.sub(i,n),e[s].x=n.x+r.x*t,e[s].y=n.y+r.y*o;return e},a.chamfer=function(e,t,o,n,i){t="number"==typeof t?[t]:t||[8],o=void 0!==o?o:-1,n=n||2,i=i||14;for(var r=[],s=0;s<e.length;s++){var a=e[0<=s-1?s-1:e.length-1],l=e[s],c=e[(s+1)%e.length],d=t[s<t.length?s:t.length-1];if(0!==d){var u=b.normalise({x:l.y-a.y,y:a.x-l.x}),p=b.normalise({x:c.y-l.y,y:l.x-c.x}),m=Math.sqrt(2*Math.pow(d,2)),f=b.mult(w.clone(u),d),v=b.normalise(b.mult(b.add(u,p),.5)),y=b.sub(l,b.mult(v,m)),g=o;-1===o&&(g=1.75*Math.pow(d,.32)),(g=w.clamp(g,n,i))%2==1&&(g+=1);for(var x=Math.acos(b.dot(u,p))/g,h=0;h<g;h++)r.push(b.add(b.rotate(f,x*h),y))}else r.push(l)}return r},a.clockwiseSort=function(e){var o=a.mean(e);return e.sort(function(e,t){return b.angle(o,e)-b.angle(o,t)}),e},a.isConvex=function(e){var t,o,n,i,r=0,s=e.length;if(s<3)return null;for(t=0;t<s;t++)if(n=(t+2)%s,i=(e[o=(t+1)%s].x-e[t].x)*(e[n].y-e[o].y),(i-=(e[o].y-e[t].y)*(e[n].x-e[o].x))<0?r|=1:0<i&&(r|=2),3===r)return!1;return 0!==r||null},a.hull=function(e){var t,o,n=[],i=[];for((e=e.slice(0)).sort(function(e,t){var o=e.x-t.x;return 0!==o?o:e.y-t.y}),o=0;o<e.length;o+=1){for(t=e[o];2<=i.length&&b.cross3(i[i.length-2],i[i.length-1],t)<=0;)i.pop();i.push(t)}for(o=e.length-1;0<=o;o-=1){for(t=e[o];2<=n.length&&b.cross3(n[n.length-2],n[n.length-1],t)<=0;)n.pop();n.push(t)}return n.pop(),i.pop(),n.concat(i)}},{"../core/Common":14,"../geometry/Vector":28}],30:[function(e,t,o){var n=t.exports=e("../core/Matter");n.Body=e("../body/Body"),n.Composite=e("../body/Composite"),n.World=e("../body/World"),n.Contact=e("../collision/Contact"),n.Detector=e("../collision/Detector"),n.Grid=e("../collision/Grid"),n.Pairs=e("../collision/Pairs"),n.Pair=e("../collision/Pair"),n.Query=e("../collision/Query"),n.Resolver=e("../collision/Resolver"),n.SAT=e("../collision/SAT"),n.Constraint=e("../constraint/Constraint"),n.MouseConstraint=e("../constraint/MouseConstraint"),n.Common=e("../core/Common"),n.Engine=e("../core/Engine"),n.Events=e("../core/Events"),n.Mouse=e("../core/Mouse"),n.Runner=e("../core/Runner"),n.Sleeping=e("../core/Sleeping"),n.Plugin=e("../core/Plugin"),n.Bodies=e("../factory/Bodies"),n.Composites=e("../factory/Composites"),n.Axes=e("../geometry/Axes"),n.Bounds=e("../geometry/Bounds"),n.Svg=e("../geometry/Svg"),n.Vector=e("../geometry/Vector"),n.Vertices=e("../geometry/Vertices"),n.Render=e("../render/Render"),n.RenderPixi=e("../render/RenderPixi"),n.World.add=n.Composite.add,n.World.remove=n.Composite.remove,n.World.addComposite=n.Composite.addComposite,n.World.addBody=n.Composite.addBody,n.World.addConstraint=n.Composite.addConstraint,n.World.clear=n.Composite.clear,n.Engine.run=n.Runner.run},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Contact":4,"../collision/Detector":5,"../collision/Grid":6,"../collision/Pair":7,"../collision/Pairs":8,"../collision/Query":9,"../collision/Resolver":10,"../collision/SAT":11,"../constraint/Constraint":12,"../constraint/MouseConstraint":13,"../core/Common":14,"../core/Engine":15,"../core/Events":16,"../core/Matter":17,"../core/Metrics":18,"../core/Mouse":19,"../core/Plugin":20,"../core/Runner":21,"../core/Sleeping":22,"../factory/Bodies":23,"../factory/Composites":24,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Svg":27,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31,"../render/RenderPixi":32}],31:[function(e,t,o){var b={};t.exports=b;var y=e("../core/Common"),w=e("../body/Composite"),S=e("../geometry/Bounds"),C=e("../core/Events"),A=e("../collision/Grid"),P=e("../geometry/Vector"),B=e("../core/Mouse");!function(){var n,t;"undefined"!=typeof window&&(n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(function(){e(y.now())},1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),b.create=function(e){var t={controller:b,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,options:{width:800,height:600,pixelRatio:1,background:"#18181d",wireframeBackground:"#0f0f13",hasBounds:!!e.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},o=y.extend(t,e);return o.canvas&&(o.canvas.width=o.options.width||o.canvas.width,o.canvas.height=o.options.height||o.canvas.height),o.mouse=e.mouse,o.engine=e.engine,o.canvas=o.canvas||i(o.options.width,o.options.height),o.context=o.canvas.getContext("2d"),o.textures={},o.bounds=o.bounds||{min:{x:0,y:0},max:{x:o.canvas.width,y:o.canvas.height}},1!==o.options.pixelRatio&&b.setPixelRatio(o,o.options.pixelRatio),y.isElement(o.element)?o.element.appendChild(o.canvas):o.canvas.parentNode||y.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn"),o},b.run=function(o){!function e(t){o.frameRequestId=n(e),b.world(o)}()},b.stop=function(e){t(e.frameRequestId)},b.setPixelRatio=function(e,t){var o=e.options,n=e.canvas;"auto"===t&&(t=r(n)),o.pixelRatio=t,n.setAttribute("data-pixel-ratio",t),n.width=o.width*t,n.height=o.height*t,n.style.width=o.width+"px",n.style.height=o.height+"px",e.context.scale(t,t)},b.lookAt=function(e,t,o,n){n=void 0===n||n,t=y.isArray(t)?t:[t],o=o||{x:0,y:0};for(var i={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},r=0;r<t.length;r+=1){var s=t[r],a=s.bounds?s.bounds.min:s.min||s.position||s,l=s.bounds?s.bounds.max:s.max||s.position||s;a&&l&&(a.x<i.min.x&&(i.min.x=a.x),l.x>i.max.x&&(i.max.x=l.x),a.y<i.min.y&&(i.min.y=a.y),l.y>i.max.y&&(i.max.y=l.y))}var c=i.max.x-i.min.x+2*o.x,d=i.max.y-i.min.y+2*o.y,u=e.canvas.height,p=e.canvas.width/u,m=c/d,f=1,v=1;p<m?v=m/p:f=p/m,e.options.hasBounds=!0,e.bounds.min.x=i.min.x,e.bounds.max.x=i.min.x+c*f,e.bounds.min.y=i.min.y,e.bounds.max.y=i.min.y+d*v,n&&(e.bounds.min.x+=.5*c-c*f*.5,e.bounds.max.x+=.5*c-c*f*.5,e.bounds.min.y+=.5*d-d*v*.5,e.bounds.max.y+=.5*d-d*v*.5),e.bounds.min.x-=o.x,e.bounds.max.x-=o.x,e.bounds.min.y-=o.y,e.bounds.max.y-=o.y,e.mouse&&(B.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),B.setOffset(e.mouse,e.bounds.min))},b.startViewTransform=function(e){var t=e.bounds.max.x-e.bounds.min.x,o=e.bounds.max.y-e.bounds.min.y,n=t/e.options.width,i=o/e.options.height;e.context.scale(1/n,1/i),e.context.translate(-e.bounds.min.x,-e.bounds.min.y)},b.endViewTransform=function(e){e.context.setTransform(e.options.pixelRatio,0,0,e.options.pixelRatio,0,0)},b.world=function(e){var t,o=e.engine,n=o.world,i=e.canvas,r=e.context,s=e.options,a=w.allBodies(n),l=w.allConstraints(n),c=s.wireframes?s.wireframeBackground:s.background,d=[],u=[],p={timestamp:o.timing.timestamp};if(C.trigger(e,"beforeRender",p),e.currentBackground!==c&&h(e,c),r.globalCompositeOperation="source-in",r.fillStyle="transparent",r.fillRect(0,0,i.width,i.height),r.globalCompositeOperation="source-over",s.hasBounds){for(t=0;t<a.length;t++){var m=a[t];S.overlaps(m.bounds,e.bounds)&&d.push(m)}for(t=0;t<l.length;t++){var f=l[t],v=f.bodyA,y=f.bodyB,g=f.pointA,x=f.pointB;v&&(g=P.add(v.position,f.pointA)),y&&(x=P.add(y.position,f.pointB)),g&&x&&((S.contains(e.bounds,g)||S.contains(e.bounds,x))&&u.push(f))}b.startViewTransform(e),e.mouse&&(B.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),B.setOffset(e.mouse,e.bounds.min))}else u=l,d=a;!s.wireframes||o.enableSleeping&&s.showSleeping?b.bodies(e,d,r):(s.showConvexHulls&&b.bodyConvexHulls(e,d,r),b.bodyWireframes(e,d,r)),s.showBounds&&b.bodyBounds(e,d,r),(s.showAxes||s.showAngleIndicator)&&b.bodyAxes(e,d,r),s.showPositions&&b.bodyPositions(e,d,r),s.showVelocity&&b.bodyVelocity(e,d,r),s.showGravity&&b.bodyGravity(e,d,r),s.showIds&&b.bodyIds(e,d,r),s.showSeparations&&b.separations(e,o.pairs.list,r),s.showCollisions&&b.collisions(e,o.pairs.list,r),s.showVertexNumbers&&b.vertexNumbers(e,d,r),s.showMousePosition&&b.mousePosition(e,e.mouse,r),b.constraints(u,r),s.showBroadphase&&o.broadphase.controller===A&&b.grid(e,o.broadphase,r),s.showDebug&&b.debug(e,r),s.hasBounds&&b.endViewTransform(e),C.trigger(e,"afterRender",p)},b.debug=function(e,t){var o=t,n=e.engine,i=n.world,r=n.metrics,s=e.options;w.allBodies(i);if(500<=n.timing.timestamp-(e.debugTimestamp||0)){var a="";r.timing&&(a+="fps: "+Math.round(r.timing.fps)+"    "),e.debugString=a,e.debugTimestamp=n.timing.timestamp}if(e.debugString){o.font="12px Arial",s.wireframes?o.fillStyle="rgba(255,255,255,0.5)":o.fillStyle="rgba(0,0,0,0.5)";for(var l=e.debugString.split("\n"),c=0;c<l.length;c++)o.fillText(l[c],50,50+18*c)}},b.constraints=function(e,t){for(var o=t,n=0;n<e.length;n++){var i=e[n];if(i.render.visible&&i.pointA&&i.pointB){var r,s,a=i.bodyA,l=i.bodyB;if(r=a?P.add(a.position,i.pointA):i.pointA,"pin"===i.render.type)o.beginPath(),o.arc(r.x,r.y,3,0,2*Math.PI),o.closePath();else{if(s=l?P.add(l.position,i.pointB):i.pointB,o.beginPath(),o.moveTo(r.x,r.y),"spring"===i.render.type)for(var c,d=P.sub(s,r),u=P.perp(P.normalise(d)),p=Math.ceil(y.clamp(i.length/5,12,20)),m=1;m<p;m+=1)c=m%2==0?1:-1,o.lineTo(r.x+d.x*(m/p)+u.x*c*4,r.y+d.y*(m/p)+u.y*c*4);o.lineTo(s.x,s.y)}i.render.lineWidth&&(o.lineWidth=i.render.lineWidth,o.strokeStyle=i.render.strokeStyle,o.stroke()),i.render.anchors&&(o.fillStyle=i.render.strokeStyle,o.beginPath(),o.arc(r.x,r.y,3,0,2*Math.PI),o.arc(s.x,s.y,3,0,2*Math.PI),o.closePath(),o.fill())}}},b.bodyShadows=function(e,t,o){for(var n=o,i=(e.engine,0);i<t.length;i++){var r=t[i];if(r.render.visible){if(r.circleRadius)n.beginPath(),n.arc(r.position.x,r.position.y,r.circleRadius,0,2*Math.PI),n.closePath();else{n.beginPath(),n.moveTo(r.vertices[0].x,r.vertices[0].y);for(var s=1;s<r.vertices.length;s++)n.lineTo(r.vertices[s].x,r.vertices[s].y);n.closePath()}var a=r.position.x-.5*e.options.width,l=r.position.y-.2*e.options.height,c=Math.abs(a)+Math.abs(l);n.shadowColor="rgba(0,0,0,0.15)",n.shadowOffsetX=.05*a,n.shadowOffsetY=.05*l,n.shadowBlur=1+12*Math.min(1,c/1e3),n.fill(),n.shadowColor=null,n.shadowOffsetX=null,n.shadowOffsetY=null,n.shadowBlur=null}}},b.bodies=function(e,t,o){var n,i,r,s,a=o,l=(e.engine,e.options),c=l.showInternalEdges||!l.wireframes;for(r=0;r<t.length;r++)if((n=t[r]).render.visible)for(s=1<n.parts.length?1:0;s<n.parts.length;s++)if((i=n.parts[s]).render.visible){if(l.showSleeping&&n.isSleeping?a.globalAlpha=.5*i.render.opacity:1!==i.render.opacity&&(a.globalAlpha=i.render.opacity),i.render.sprite&&i.render.sprite.texture&&!l.wireframes){var d=i.render.sprite,u=m(e,d.texture);a.translate(i.position.x,i.position.y),a.rotate(i.angle),a.drawImage(u,u.width*-d.xOffset*d.xScale,u.height*-d.yOffset*d.yScale,u.width*d.xScale,u.height*d.yScale),a.rotate(-i.angle),a.translate(-i.position.x,-i.position.y)}else{if(i.circleRadius)a.beginPath(),a.arc(i.position.x,i.position.y,i.circleRadius,0,2*Math.PI);else{a.beginPath(),a.moveTo(i.vertices[0].x,i.vertices[0].y);for(var p=1;p<i.vertices.length;p++)!i.vertices[p-1].isInternal||c?a.lineTo(i.vertices[p].x,i.vertices[p].y):a.moveTo(i.vertices[p].x,i.vertices[p].y),i.vertices[p].isInternal&&!c&&a.moveTo(i.vertices[(p+1)%i.vertices.length].x,i.vertices[(p+1)%i.vertices.length].y);a.lineTo(i.vertices[0].x,i.vertices[0].y),a.closePath()}l.wireframes?(a.lineWidth=1,a.strokeStyle="#bbb",a.stroke()):(a.fillStyle=i.render.fillStyle,i.render.lineWidth&&(a.lineWidth=i.render.lineWidth,a.strokeStyle=i.render.strokeStyle,a.stroke()),a.fill())}a.globalAlpha=1}},b.bodyWireframes=function(e,t,o){var n,i,r,s,a,l=o,c=e.options.showInternalEdges;for(l.beginPath(),r=0;r<t.length;r++)if((n=t[r]).render.visible)for(a=1<n.parts.length?1:0;a<n.parts.length;a++){for(i=n.parts[a],l.moveTo(i.vertices[0].x,i.vertices[0].y),s=1;s<i.vertices.length;s++)!i.vertices[s-1].isInternal||c?l.lineTo(i.vertices[s].x,i.vertices[s].y):l.moveTo(i.vertices[s].x,i.vertices[s].y),i.vertices[s].isInternal&&!c&&l.moveTo(i.vertices[(s+1)%i.vertices.length].x,i.vertices[(s+1)%i.vertices.length].y);l.lineTo(i.vertices[0].x,i.vertices[0].y)}l.lineWidth=1,l.strokeStyle="#bbb",l.stroke()},b.bodyConvexHulls=function(e,t,o){var n,i,r,s=o;for(s.beginPath(),i=0;i<t.length;i++)if((n=t[i]).render.visible&&1!==n.parts.length){for(s.moveTo(n.vertices[0].x,n.vertices[0].y),r=1;r<n.vertices.length;r++)s.lineTo(n.vertices[r].x,n.vertices[r].y);s.lineTo(n.vertices[0].x,n.vertices[0].y)}s.lineWidth=1,s.strokeStyle="rgba(255,255,255,0.2)",s.stroke()},b.vertexNumbers=function(e,t,o){var n,i,r,s=o;for(n=0;n<t.length;n++){var a=t[n].parts;for(r=1<a.length?1:0;r<a.length;r++){var l=a[r];for(i=0;i<l.vertices.length;i++)s.fillStyle="rgba(255,255,255,0.2)",s.fillText(n+"_"+i,l.position.x+.8*(l.vertices[i].x-l.position.x),l.position.y+.8*(l.vertices[i].y-l.position.y))}}},b.mousePosition=function(e,t,o){var n=o;n.fillStyle="rgba(255,255,255,0.8)",n.fillText(t.position.x+"  "+t.position.y,t.position.x+5,t.position.y-5)},b.bodyBounds=function(e,t,o){var n=o,i=(e.engine,e.options);n.beginPath();for(var r=0;r<t.length;r++){if(t[r].render.visible)for(var s=t[r].parts,a=1<s.length?1:0;a<s.length;a++){var l=s[a];n.rect(l.bounds.min.x,l.bounds.min.y,l.bounds.max.x-l.bounds.min.x,l.bounds.max.y-l.bounds.min.y)}}i.wireframes?n.strokeStyle="rgba(255,255,255,0.08)":n.strokeStyle="rgba(0,0,0,0.1)",n.lineWidth=1,n.stroke()},b.bodyAxes=function(e,t,o){var n,i,r,s,a=o,l=(e.engine,e.options);for(a.beginPath(),i=0;i<t.length;i++){var c=t[i],d=c.parts;if(c.render.visible)if(l.showAxes)for(r=1<d.length?1:0;r<d.length;r++)for(n=d[r],s=0;s<n.axes.length;s++){var u=n.axes[s];a.moveTo(n.position.x,n.position.y),a.lineTo(n.position.x+20*u.x,n.position.y+20*u.y)}else for(r=1<d.length?1:0;r<d.length;r++)for(n=d[r],s=0;s<n.axes.length;s++)a.moveTo(n.position.x,n.position.y),a.lineTo((n.vertices[0].x+n.vertices[n.vertices.length-1].x)/2,(n.vertices[0].y+n.vertices[n.vertices.length-1].y)/2)}l.wireframes?(a.strokeStyle="indianred",a.lineWidth=1):(a.strokeStyle="rgba(255, 255, 255, 0.4)",a.globalCompositeOperation="overlay",a.lineWidth=2),a.stroke(),a.globalCompositeOperation="source-over"},b.bodyPositions=function(e,t,o){var n,i,r,s,a=o,l=(e.engine,e.options);for(a.beginPath(),r=0;r<t.length;r++)if((n=t[r]).render.visible)for(s=0;s<n.parts.length;s++)i=n.parts[s],a.arc(i.position.x,i.position.y,3,0,2*Math.PI,!1),a.closePath();for(l.wireframes?a.fillStyle="indianred":a.fillStyle="rgba(0,0,0,0.5)",a.fill(),a.beginPath(),r=0;r<t.length;r++)(n=t[r]).render.visible&&(a.arc(n.positionPrev.x,n.positionPrev.y,2,0,2*Math.PI,!1),a.closePath());a.fillStyle="rgba(255,165,0,0.8)",a.fill()},b.bodyVelocity=function(e,t,o){var n=o;n.beginPath();for(var i=0;i<t.length;i++){var r=t[i];r.render.visible&&(n.moveTo(r.position.x,r.position.y),n.lineTo(r.position.x+4*(r.position.x-r.positionPrev.x),r.position.y+4*(r.position.y-r.positionPrev.y)))}n.lineWidth=3,n.strokeStyle="cornflowerblue",n.stroke()},b.bodyGravity=function(e,t,o){var n=o;n.beginPath();for(var i=0;i<t.length;i++){var r=t[i];r.render.visible&&(n.moveTo(r.position.x,r.position.y),n.lineTo(r.position.x,r.position.y+40))}n.lineWidth=3,n.strokeStyle="#ee6e24",n.stroke()},b.bodyIds=function(e,t,o){var n,i,r=o;for(n=0;n<t.length;n++)if(t[n].render.visible){var s=t[n].parts;for(i=1<s.length?1:0;i<s.length;i++){var a=s[i];r.font="12px Arial",r.fillStyle="rgba(255,255,255,0.5)",r.fillText(a.id,a.position.x+10,a.position.y-10)}}},b.collisions=function(e,t,o){var n,i,r,s,a=o,l=e.options;for(a.beginPath(),r=0;r<t.length;r++)if((n=t[r]).isActive)for(i=n.collision,s=0;s<n.activeContacts.length;s++){var c=n.activeContacts[s].vertex;a.rect(c.x-1.5,c.y-1.5,3.5,3.5)}for(l.wireframes?a.fillStyle="rgba(255,255,255,0.7)":a.fillStyle="orange",a.fill(),a.beginPath(),r=0;r<t.length;r++)if((n=t[r]).isActive&&(i=n.collision,0<n.activeContacts.length)){var d=n.activeContacts[0].vertex.x,u=n.activeContacts[0].vertex.y;2===n.activeContacts.length&&(d=(n.activeContacts[0].vertex.x+n.activeContacts[1].vertex.x)/2,u=(n.activeContacts[0].vertex.y+n.activeContacts[1].vertex.y)/2),i.bodyB===i.supports[0].body||!0===i.bodyA.isStatic?a.moveTo(d-8*i.normal.x,u-8*i.normal.y):a.moveTo(d+8*i.normal.x,u+8*i.normal.y),a.lineTo(d,u)}l.wireframes?a.strokeStyle="rgba(255,165,0,0.7)":a.strokeStyle="orange",a.lineWidth=1,a.stroke()},b.separations=function(e,t,o){var n,i,r,s,a,l=o,c=e.options;for(l.beginPath(),a=0;a<t.length;a++)if((n=t[a]).isActive){r=(i=n.collision).bodyA;var d=1;(s=i.bodyB).isStatic||r.isStatic||(d=.5),s.isStatic&&(d=0),l.moveTo(s.position.x,s.position.y),l.lineTo(s.position.x-i.penetration.x*d,s.position.y-i.penetration.y*d),d=1,s.isStatic||r.isStatic||(d=.5),r.isStatic&&(d=0),l.moveTo(r.position.x,r.position.y),l.lineTo(r.position.x+i.penetration.x*d,r.position.y+i.penetration.y*d)}c.wireframes?l.strokeStyle="rgba(255,165,0,0.5)":l.strokeStyle="orange",l.stroke()},b.grid=function(e,t,o){var n=o;e.options.wireframes?n.strokeStyle="rgba(255,180,0,0.1)":n.strokeStyle="rgba(255,180,0,0.5)",n.beginPath();for(var i=y.keys(t.buckets),r=0;r<i.length;r++){var s=i[r];if(!(t.buckets[s].length<2)){var a=s.split(/C|R/);n.rect(.5+parseInt(a[1],10)*t.bucketWidth,.5+parseInt(a[2],10)*t.bucketHeight,t.bucketWidth,t.bucketHeight)}}n.lineWidth=1,n.stroke()},b.inspector=function(e,t){e.engine;var o,n=e.selected,i=e.render,r=i.options;if(r.hasBounds){var s=i.bounds.max.x-i.bounds.min.x,a=i.bounds.max.y-i.bounds.min.y,l=s/i.options.width,c=a/i.options.height;t.scale(1/l,1/c),t.translate(-i.bounds.min.x,-i.bounds.min.y)}for(var d=0;d<n.length;d++){var u=n[d].data;switch(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.9)",t.setLineDash([1,2]),u.type){case"body":o=u.bounds,t.beginPath(),t.rect(Math.floor(o.min.x-3),Math.floor(o.min.y-3),Math.floor(o.max.x-o.min.x+6),Math.floor(o.max.y-o.min.y+6)),t.closePath(),t.stroke();break;case"constraint":var p=u.pointA;u.bodyA&&(p=u.pointB),t.beginPath(),t.arc(p.x,p.y,10,0,2*Math.PI),t.closePath(),t.stroke()}t.setLineDash([]),t.translate(-.5,-.5)}null!==e.selectStart&&(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.6)",t.fillStyle="rgba(255,165,0,0.1)",o=e.selectBounds,t.beginPath(),t.rect(Math.floor(o.min.x),Math.floor(o.min.y),Math.floor(o.max.x-o.min.x),Math.floor(o.max.y-o.min.y)),t.closePath(),t.stroke(),t.fill(),t.translate(-.5,-.5)),r.hasBounds&&t.setTransform(1,0,0,1,0,0)};var i=function(e,t){var o=document.createElement("canvas");return o.width=e,o.height=t,o.oncontextmenu=function(){return!1},o.onselectstart=function(){return!1},o},r=function(e){var t=e.getContext("2d");return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)},m=function(e,t){var o=e.textures[t];return o||((o=e.textures[t]=new Image).src=t,o)},h=function(e,t){var o=t;/(jpg|gif|png)$/.test(t)&&(o="url("+t+")"),e.canvas.style.background=o,e.canvas.style.backgroundSize="contain",e.currentBackground=t}}()},{"../body/Composite":2,"../collision/Grid":6,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../geometry/Bounds":26,"../geometry/Vector":28}],32:[function(e,t,o){var h={};t.exports=h;var b=e("../geometry/Bounds"),w=e("../body/Composite"),m=e("../core/Common"),i=e("../core/Events"),S=e("../geometry/Vector");!function(){var n,t;"undefined"!=typeof window&&(n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(function(){e(m.now())},1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),h.create=function(e){m.warn("RenderPixi.create: Matter.RenderPixi is deprecated (see docs)");var t={controller:h,engine:null,element:null,frameRequestId:null,canvas:null,renderer:null,container:null,spriteContainer:null,pixiOptions:null,options:{width:800,height:600,background:"#fafafa",wireframeBackground:"#222",hasBounds:!1,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1}},o=m.extend(t,e),n=!o.options.wireframes&&"transparent"===o.options.background;return o.pixiOptions=o.pixiOptions||{view:o.canvas,transparent:n,antialias:!0,backgroundColor:e.background},o.mouse=e.mouse,o.engine=e.engine,o.renderer=o.renderer||new PIXI.WebGLRenderer(o.options.width,o.options.height,o.pixiOptions),o.container=o.container||new PIXI.Container,o.spriteContainer=o.spriteContainer||new PIXI.Container,o.canvas=o.canvas||o.renderer.view,o.bounds=o.bounds||{min:{x:0,y:0},max:{x:o.options.width,y:o.options.height}},i.on(o.engine,"beforeUpdate",function(){h.clear(o)}),o.textures={},o.sprites={},o.primitives={},o.container.addChild(o.spriteContainer),m.isElement(o.element)?o.element.appendChild(o.canvas):m.warn('No "render.element" passed, "render.canvas" was not inserted into document.'),o.canvas.oncontextmenu=function(){return!1},o.canvas.onselectstart=function(){return!1},o},h.run=function(o){!function e(t){o.frameRequestId=n(e),h.world(o)}()},h.stop=function(e){t(e.frameRequestId)},h.clear=function(e){for(var t=e.container,o=e.spriteContainer;t.children[0];)t.removeChild(t.children[0]);for(;o.children[0];)o.removeChild(o.children[0]);var n=e.sprites["bg-0"];e.textures={},e.sprites={},e.primitives={},(e.sprites["bg-0"]=n)&&t.addChildAt(n,0),e.container.addChild(e.spriteContainer),e.currentBackground=null,t.scale.set(1,1),t.position.set(0,0)},h.setBackground=function(e,t){if(e.currentBackground!==t){var o=t.indexOf&&-1!==t.indexOf("#"),n=e.sprites["bg-0"];if(o){var i=m.colorToNumber(t);e.renderer.backgroundColor=i,n&&e.container.removeChild(n)}else if(!n){var r=s(e,t);(n=e.sprites["bg-0"]=new PIXI.Sprite(r)).position.x=0,n.position.y=0,e.container.addChildAt(n,0)}e.currentBackground=t}},h.world=function(e){var t,o=e.engine.world,n=e.renderer,i=e.container,r=e.options,s=w.allBodies(o),a=w.allConstraints(o),l=[];r.wireframes?h.setBackground(e,r.wireframeBackground):h.setBackground(e,r.background);var c=e.bounds.max.x-e.bounds.min.x,d=e.bounds.max.y-e.bounds.min.y,u=c/e.options.width,p=d/e.options.height;if(r.hasBounds){for(t=0;t<s.length;t++){var m=s[t];m.render.sprite.visible=b.overlaps(m.bounds,e.bounds)}for(t=0;t<a.length;t++){var f=a[t],v=f.bodyA,y=f.bodyB,g=f.pointA,x=f.pointB;v&&(g=S.add(v.position,f.pointA)),y&&(x=S.add(y.position,f.pointB)),g&&x&&((b.contains(e.bounds,g)||b.contains(e.bounds,x))&&l.push(f))}i.scale.set(1/u,1/p),i.position.set(-e.bounds.min.x*(1/u),-e.bounds.min.y*(1/p))}else l=a;for(t=0;t<s.length;t++)h.body(e,s[t]);for(t=0;t<l.length;t++)h.constraint(e,l[t]);n.render(i)},h.constraint=function(e,t){e.engine;var o=t.bodyA,n=t.bodyB,i=t.pointA,r=t.pointB,s=e.container,a=t.render,l="c-"+t.id,c=e.primitives[l];c||(c=e.primitives[l]=new PIXI.Graphics),a.visible&&t.pointA&&t.pointB?(-1===m.indexOf(s.children,c)&&s.addChild(c),c.clear(),c.beginFill(0,0),c.lineStyle(a.lineWidth,m.colorToNumber(a.strokeStyle),1),o?c.moveTo(o.position.x+i.x,o.position.y+i.y):c.moveTo(i.x,i.y),n?c.lineTo(n.position.x+r.x,n.position.y+r.y):c.lineTo(r.x,r.y),c.endFill()):c.clear()},h.body=function(e,t){e.engine;var o=t.render;if(o.visible)if(o.sprite&&o.sprite.texture){var n="b-"+t.id,i=e.sprites[n],r=e.spriteContainer;i||(i=e.sprites[n]=c(e,t)),-1===m.indexOf(r.children,i)&&r.addChild(i),i.position.x=t.position.x,i.position.y=t.position.y,i.rotation=t.angle,i.scale.x=o.sprite.xScale||1,i.scale.y=o.sprite.yScale||1}else{var s="b-"+t.id,a=e.primitives[s],l=e.container;a||((a=e.primitives[s]=d(e,t)).initialAngle=t.angle),-1===m.indexOf(l.children,a)&&l.addChild(a),a.position.x=t.position.x,a.position.y=t.position.y,a.rotation=t.angle-a.initialAngle}};var c=function(e,t){var o=t.render.sprite.texture,n=s(e,o),i=new PIXI.Sprite(n);return i.anchor.x=t.render.sprite.xOffset,i.anchor.y=t.render.sprite.yOffset,i},d=function(e,t){var o,n=t.render,i=e.options,r=new PIXI.Graphics,s=m.colorToNumber(n.fillStyle),a=m.colorToNumber(n.strokeStyle),l=m.colorToNumber(n.strokeStyle),c=m.colorToNumber("#bbb"),d=m.colorToNumber("#CD5C5C");r.clear();for(var u=1<t.parts.length?1:0;u<t.parts.length;u++){o=t.parts[u],i.wireframes?(r.beginFill(0,0),r.lineStyle(1,c,1)):(r.beginFill(s,1),r.lineStyle(n.lineWidth,a,1)),r.moveTo(o.vertices[0].x-t.position.x,o.vertices[0].y-t.position.y);for(var p=1;p<o.vertices.length;p++)r.lineTo(o.vertices[p].x-t.position.x,o.vertices[p].y-t.position.y);r.lineTo(o.vertices[0].x-t.position.x,o.vertices[0].y-t.position.y),r.endFill(),(i.showAngleIndicator||i.showAxes)&&(r.beginFill(0,0),i.wireframes?r.lineStyle(1,d,1):r.lineStyle(1,l),r.moveTo(o.position.x-t.position.x,o.position.y-t.position.y),r.lineTo((o.vertices[0].x+o.vertices[o.vertices.length-1].x)/2-t.position.x,(o.vertices[0].y+o.vertices[o.vertices.length-1].y)/2-t.position.y),r.endFill())}return r},s=function(e,t){var o=e.textures[t];return o||(o=e.textures[t]=PIXI.Texture.fromImage(t)),o}}()},{"../body/Composite":2,"../core/Common":14,"../core/Events":16,"../geometry/Bounds":26,"../geometry/Vector":28}]},{},[30])(30)});